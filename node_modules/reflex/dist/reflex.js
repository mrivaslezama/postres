(function (global, factory) {
  if (typeof define === "function" && define.amd) {
    define(["exports", "./task", "./effects", "./dom", "./subscription"], factory);
  } else if (typeof exports !== "undefined") {
    factory(exports, require("./task"), require("./effects"), require("./dom"), require("./subscription"));
  } else {
    var mod = {
      exports: {}
    };
    factory(mod.exports, global.task, global.effects, global.dom, global.subscription);
    global.application = mod.exports;
  }
})(this, function (exports, _task, _effects, _dom, _subscription) {
  "use strict";

  Object.defineProperty(exports, "__esModule", {
    value: true
  });
  exports.start = exports.beginner = undefined;


  class Application {
    constructor(send, model, view, task, services) {
      this.send = send;
      this.model = model;
      this.view = view;
      this.task = task;
      this.services = services;
    }

  }

  const first = xs => xs[0];
  const second = xs => xs[1];

  const beginner = exports.beginner = configuration => ({
    flags: void 0,
    init: _ => [configuration.model, _effects.Effects.none],
    update: (model, action) => [configuration.update(model, action), _effects.Effects.none],
    view: configuration.view,
    subscriptions: model => _subscription.none
  });

  const noSubscribtions = _ => _subscription.none;

  const start = exports.start = configuration => write => {
    const { init, view, update, flags } = configuration;
    const subscriptions = configuration.subscriptions == null ? noSubscribtions : configuration.subscriptions;

    const send = action => {
      const [model, fx] = update(application.model, action);
      application.model = model;
      application.view = (0, _dom.root)(view, model, send);
      application.task = fx.execute(send);

      application.services = subscriptions(model).reduce(subscribe, application.services);
      exectueServices(application.services, send);
      write(application);
    };

    const [model, fx] = init(flags);

    const application = new Application(send, model, (0, _dom.root)(view, model, send), fx.execute(send), subscriptions(model).reduce(subscribe, {
      nextAddress: 0,
      active: Object.create(null)
    }));

    exectueServices(application.services, send);
    return write(application);
  };

  const subscribe = (services, subscription) => {
    const { active } = services;
    const { feed, detail } = subscription;
    const service = active[String(feed.address)];

    if (service == null || service.feed !== feed) {
      const address = `/${++services.nextAddress}`;
      const subscriptions = [subscription];
      const state = feed.init();
      feed.address = address;

      active[address] = { feed, subscriptions, state };
    } else {
      service.subscriptions.push(subscription);
    }

    return services;
  };

  const exectueServices = (services, send) => {
    for (let address in services.active) {
      exectueService(services.active[address], send);
    }
  };

  const exectueService = (service, send) => {
    const { state, feed, subscriptions } = service;
    const [model, fx] = feed.update(state, feed.subscribe(subscriptions));
    service.state = model;
    fx.execute(send);
  };
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9hcHBsaWNhdGlvbi5qcyJdLCJuYW1lcyI6WyJBcHBsaWNhdGlvbiIsImNvbnN0cnVjdG9yIiwic2VuZCIsIm1vZGVsIiwidmlldyIsInRhc2siLCJzZXJ2aWNlcyIsImZpcnN0IiwieHMiLCJzZWNvbmQiLCJiZWdpbm5lciIsImNvbmZpZ3VyYXRpb24iLCJmbGFncyIsImluaXQiLCJfIiwibm9uZSIsInVwZGF0ZSIsImFjdGlvbiIsInN1YnNjcmlwdGlvbnMiLCJub1N1YnNjcmlidGlvbnMiLCJzdGFydCIsIndyaXRlIiwiZngiLCJhcHBsaWNhdGlvbiIsImV4ZWN1dGUiLCJyZWR1Y2UiLCJzdWJzY3JpYmUiLCJleGVjdHVlU2VydmljZXMiLCJuZXh0QWRkcmVzcyIsImFjdGl2ZSIsIk9iamVjdCIsImNyZWF0ZSIsInN1YnNjcmlwdGlvbiIsImZlZWQiLCJkZXRhaWwiLCJzZXJ2aWNlIiwiU3RyaW5nIiwiYWRkcmVzcyIsInN0YXRlIiwicHVzaCIsImV4ZWN0dWVTZXJ2aWNlIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFxQ0EsUUFBTUEsV0FBTixDQUFrQztBQUNoQ0MsZ0JBQ0VDLElBREYsRUFFRUMsS0FGRixFQUdFQyxJQUhGLEVBSUVDLElBSkYsRUFLRUMsUUFMRixFQU1FO0FBQ0EsV0FBS0osSUFBTCxHQUFZQSxJQUFaO0FBQ0EsV0FBS0MsS0FBTCxHQUFhQSxLQUFiO0FBQ0EsV0FBS0MsSUFBTCxHQUFZQSxJQUFaO0FBQ0EsV0FBS0MsSUFBTCxHQUFZQSxJQUFaO0FBQ0EsV0FBS0MsUUFBTCxHQUFnQkEsUUFBaEI7QUFDRDs7QUFiK0I7O0FBMENsQyxRQUFNQyxRQUFlQyxFQUFQLElBQXlCQSxHQUFHLENBQUgsQ0FBdkM7QUFDQSxRQUFNQyxTQUFnQkQsRUFBUCxJQUF5QkEsR0FBRyxDQUFILENBQXhDOztBQUVPLFFBQU1FLDhCQUNYQyxhQURzQixLQUUwQjtBQUNoREMsV0FBTyxLQUFLLENBRG9DO0FBRWhEQyxV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QVA7QUFDRCxHQWpCRDs7QUFtQkEsUUFBTXFCLGtCQUFrQixDQUFJckIsUUFBSixFQUEyQkosSUFBM0IsS0FBZ0Q7QUFDdEUsU0FBSyxJQUFJbUMsT0FBVCxJQUFvQi9CLFNBQVN1QixNQUE3QixFQUFxQztBQUNuQ1cscUJBQWVsQyxTQUFTdUIsTUFBVCxDQUFnQlEsT0FBaEIsQ0FBZixFQUF5Q25DLElBQXpDO0FBQ0Q7QUFDRixHQUpEOztBQU1BLFFBQU1zQyxpQkFBaUIsQ0FBSUwsT0FBSixFQUErQmpDLElBQS9CLEtBQW9EO0FBQ3pFLFVBQU0sRUFBRW9DLEtBQUYsRUFBU0wsSUFBVCxFQUFlZixhQUFmLEtBQWlDaUIsT0FBdkM7QUFDQSxVQUFNLENBQUNoQyxLQUFELEVBQVFtQixFQUFSLElBQWNXLEtBQUtqQixNQUFMLENBQVlzQixLQUFaLEVBQW1CTCxLQUFLUCxTQUFMLENBQWVSLGFBQWYsQ0FBbkIsQ0FBcEI7QUFDQWlCLFlBQVFHLEtBQVIsR0FBZ0JuQyxLQUFoQjtBQUNBbUIsT0FBR0UsT0FBSCxDQUFXdEIsSUFBWDtBQUNELEdBTEQiLCJmaWxlIjoiYXBwbGljYXRpb24uanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKiBAZmxvdyAqL1xuXG5pbXBvcnQgeyBUYXNrIH0gZnJvbSBcIi4vdGFza1wiXG5pbXBvcnQgeyBFZmZlY3RzIH0gZnJvbSBcIi4vZWZmZWN0c1wiXG5pbXBvcnQgeyByb290IH0gZnJvbSBcIi4vZG9tXCJcbmltcG9ydCB0eXBlIHsgRE9NIH0gZnJvbSBcIi4vZG9tXCJcblxuaW1wb3J0IHR5cGUgeyBWaXJ0dWFsUm9vdCwgQWRkcmVzcyB9IGZyb20gXCIuL2RyaXZlclwiXG5pbXBvcnQgeyBTdWJzY3JpcHRpb24sIEZlZWQgfSBmcm9tIFwiLi9zdWJzY3JpcHRpb25cIlxuXG5pbXBvcnQgeyBub25lIH0gZnJvbSBcIi4vc3Vic2NyaXB0aW9uXCJcbmltcG9ydCB0eXBlIHsgTmV2ZXIgfSBmcm9tIFwiLi9FZmZlY3RzXCJcbmltcG9ydCB0eXBlIHsgU2VydmljZSB9IGZyb20gXCIuL3N1YnNjcmlwdGlvblwiXG5cbmV4cG9ydCB0eXBlIEluaXQ8bW9kZWwsIGFjdGlvbiwgZmxhZ3M+ID0gKFxuICBmbGFnczogZmxhZ3NcbikgPT4gW21vZGVsLCBFZmZlY3RzPGFjdGlvbj5dXG5cbmV4cG9ydCB0eXBlIFVwZGF0ZTxtb2RlbCwgYWN0aW9uPiA9IChcbiAgbW9kZWw6IG1vZGVsLFxuICBhY3Rpb246IGFjdGlvblxuKSA9PiBbbW9kZWwsIEVmZmVjdHM8YWN0aW9uPl1cblxuZXhwb3J0IHR5cGUgVmlldzxtb2RlbCwgYWN0aW9uPiA9IChcbiAgbW9kZWw6IG1vZGVsLFxuICBhZGRyZXNzOiBBZGRyZXNzPGFjdGlvbj5cbikgPT4gRE9NXG5cbmV4cG9ydCB0eXBlIFN1YnNjcmlwdGlvbnM8bW9kZWwsIGFjdGlvbj4gPSAoXG4gIHN0YXRlOiBtb2RlbFxuKSA9PiBTdWJzY3JpcHRpb248YWN0aW9uPlxuXG50eXBlIFNlcnZpY2VzPG1lc3NhZ2U+ID0ge1xuICBuZXh0QWRkcmVzczogbnVtYmVyLFxuICBhY3RpdmU6IHsgW2tleTogc3RyaW5nXTogU2VydmljZTwqLCAqLCBtZXNzYWdlPiB9XG59XG5cbmNsYXNzIEFwcGxpY2F0aW9uPHN0YXRlLCBtZXNzYWdlPiB7XG4gIGNvbnN0cnVjdG9yKFxuICAgIHNlbmQ6IEFkZHJlc3M8bWVzc2FnZT4sXG4gICAgbW9kZWw6IHN0YXRlLFxuICAgIHZpZXc6IFZpcnR1YWxSb290LFxuICAgIHRhc2s6IFRhc2s8TmV2ZXIsIHZvaWQ+LFxuICAgIHNlcnZpY2VzOiBTZXJ2aWNlczxtZXNzYWdlPlxuICApIHtcbiAgICB0aGlzLnNlbmQgPSBzZW5kXG4gICAgdGhpcy5tb2RlbCA9IG1vZGVsXG4gICAgdGhpcy52aWV3ID0gdmlld1xuICAgIHRoaXMudGFzayA9IHRhc2tcbiAgICB0aGlzLnNlcnZpY2VzID0gc2VydmljZXNcbiAgfVxuXG4gIHNlbmQ6IEFkZHJlc3M8bWVzc2FnZT5cbiAgbW9kZWw6IHN0YXRlXG4gIHZpZXc6IFZpcnR1YWxSb290XG4gIHRhc2s6IFRhc2s8TmV2ZXIsIHZvaWQ+XG4gIHNlcnZpY2VzOiBTZXJ2aWNlczxtZXNzYWdlPlxufVxuXG5leHBvcnQgdHlwZSB7IEFwcGxpY2F0aW9uIH1cblxuZXhwb3J0IHR5cGUgV3JpdGVyPG1vZGVsLCBhY3Rpb24sIG91dD4gPSAoXG4gIGFwcGxpY2F0aW9uOiBBcHBsaWNhdGlvbjxtb2RlbCwgYWN0aW9uPlxuKSA9PiBvdXRcblxuZXhwb3J0IHR5cGUgQmVnaW5uZXJDb25maWd1cmF0aW9uPG1vZGVsLCBhY3Rpb24+ID0ge1xuICBtb2RlbDogbW9kZWwsXG4gIHVwZGF0ZTogKG1vZGVsOiBtb2RlbCwgYWN0aW9uOiBhY3Rpb24pID0+IG1vZGVsLFxuICB2aWV3OiBWaWV3PG1vZGVsLCBhY3Rpb24+XG59XG5cbmV4cG9ydCB0eXBlIEFkdmFuY2VkQ29uZmlndXJhdGlvbjxtb2RlbCwgYWN0aW9uLCBmbGFncz4gPSB7XG4gIGZsYWdzOiBmbGFncyxcbiAgaW5pdDogSW5pdDxtb2RlbCwgYWN0aW9uLCBmbGFncz4sXG4gIHVwZGF0ZTogVXBkYXRlPG1vZGVsLCBhY3Rpb24+LFxuICB2aWV3OiBWaWV3PG1vZGVsLCBhY3Rpb24+LFxuICBzdWJzY3JpcHRpb25zPzogU3Vic2NyaXB0aW9uczxtb2RlbCwgYWN0aW9uPlxufVxuXG5jb25zdCBmaXJzdCA9IDxhLCBiPih4czogW2EsIGJdKTogYSA9PiB4c1swXVxuY29uc3Qgc2Vjb25kID0gPGEsIGI+KHhzOiBbYSwgYl0pOiBiID0+IHhzWzFdXG5cbmV4cG9ydCBjb25zdCBiZWdpbm5lciA9IDxtb2RlbCwgYWN0aW9uPihcbiAgY29uZmlndXJhdGlvbjogQmVnaW5uZXJDb25maWd1cmF0aW9uPG1vZGVsLCBhY3Rpb24+XG4pOiBBZHZhbmNlZENvbmZpZ3VyYXRpb248bW9kZWwsIGFjdGlvbiwgdm9pZD4gPT4gKHtcbiAgZmxhZ3M6IHZvaWQgMCxcbiAgaW5pdDogXyA9PiBbY29uZmlndXJhdGlvbi5tb2RlbCwgRWZmZWN0cy5ub25lXSxcbiAgdXBkYXRlOiAobW9kZWwsIGFjdGlvbikgPT4gW1xuICAgIGNvbmZpZ3VyYXRpb24udXBkYXRlKG1vZGVsLCBhY3Rpb24pLFxuICAgIEVmZmVjdHMubm9uZVxuICBdLFxuICB2aWV3OiBjb25maWd1cmF0aW9uLnZpZXcsXG4gIHN1YnNjcmlwdGlvbnM6IG1vZGVsID0+IG5vbmVcbn0pXG5cbmNvbnN0IG5vU3Vic2NyaWJ0aW9ucyA9IF8gPT4gbm9uZVxuXG5leHBvcnQgY29uc3Qgc3RhcnQgPSA8bW9kZWwsIG1lc3NhZ2UsIGZsYWdzPihcbiAgY29uZmlndXJhdGlvbjogQWR2YW5jZWRDb25maWd1cmF0aW9uPG1vZGVsLCBtZXNzYWdlLCBmbGFncz5cbikgPT4gPG91dD4od3JpdGU6IFdyaXRlcjxtb2RlbCwgbWVzc2FnZSwgb3V0Pik6IG91dCA9PiB7XG4gIGNvbnN0IHsgaW5pdCwgdmlldywgdXBkYXRlLCBmbGFncyB9ID0gY29uZmlndXJhdGlvblxuICBjb25zdCBzdWJzY3JpcHRpb25zID0gY29uZmlndXJhdGlvbi5zdWJzY3JpcHRpb25zID09IG51bGxcbiAgICA/IG5vU3Vic2NyaWJ0aW9uc1xuICAgIDogY29uZmlndXJhdGlvbi5zdWJzY3JpcHRpb25zXG5cbiAgY29uc3Qgc2VuZCA9IChhY3Rpb246IG1lc3NhZ2UpID0+IHtcbiAgICBjb25zdCBbbW9kZWwsIGZ4XSA9IHVwZGF0ZShhcHBsaWNhdGlvbi5tb2RlbCwgYWN0aW9uKVxuICAgIGFwcGxpY2F0aW9uLm1vZGVsID0gbW9kZWxcbiAgICBhcHBsaWNhdGlvbi52aWV3ID0gcm9vdCh2aWV3LCBtb2RlbCwgc2VuZClcbiAgICBhcHBsaWNhdGlvbi50YXNrID0gZnguZXhlY3V0ZShzZW5kKVxuXG4gICAgYXBwbGljYXRpb24uc2VydmljZXMgPSBzdWJzY3JpcHRpb25zKG1vZGVsKS5yZWR1Y2UoXG4gICAgICBzdWJzY3JpYmUsXG4gICAgICBhcHBsaWNhdGlvbi5zZXJ2aWNlc1xuICAgIClcbiAgICBleGVjdHVlU2VydmljZXMoYXBwbGljYXRpb24uc2VydmljZXMsIHNlbmQpXG4gICAgd3JpdGUoYXBwbGljYXRpb24pXG4gIH1cblxuICBjb25zdCBbbW9kZWwsIGZ4XSA9IGluaXQoZmxhZ3MpXG5cbiAgY29uc3QgYXBwbGljYXRpb24gPSBuZXcgQXBwbGljYXRpb24oXG4gICAgc2VuZCxcbiAgICBtb2RlbCxcbiAgICByb290KHZpZXcsIG1vZGVsLCBzZW5kKSxcbiAgICBmeC5leGVjdXRlKHNlbmQpLFxuICAgIHN1YnNjcmlwdGlvbnMobW9kZWwpLnJlZHVjZShzdWJzY3JpYmUsIHtcbiAgICAgIG5leHRBZGRyZXNzOiAwLFxuICAgICAgYWN0aXZlOiBPYmplY3QuY3JlYXRlKG51bGwpXG4gICAgfSlcbiAgKVxuXG4gIGV4ZWN0dWVTZXJ2aWNlcyhhcHBsaWNhdGlvbi5zZXJ2aWNlcywgc2VuZClcbiAgcmV0dXJuIHdyaXRlKGFwcGxpY2F0aW9uKVxufVxuXG5jb25zdCBzdWJzY3JpYmUgPSA8YT4oc2VydmljZXM6IFNlcnZpY2VzPGE+LCBzdWJzY3JpcHRpb24pOiBTZXJ2aWNlczxhPiA9PiB7XG4gIGNvbnN0IHsgYWN0aXZlIH0gPSBzZXJ2aWNlc1xuICBjb25zdCB7IGZlZWQsIGRldGFpbCB9ID0gc3Vic2NyaXB0aW9uXG4gIGNvbnN0IHNlcnZpY2UgPSBhY3RpdmVbU3RyaW5nKGZlZWQuYWRkcmVzcyldXG5cbiAgaWYgKHNlcnZpY2UgPT0gbnVsbCB8fCBzZXJ2aWNlLmZlZWQgIT09IGZlZWQpIHtcbiAgICBjb25zdCBhZGRyZXNzID0gYC8keysrc2VydmljZXMubmV4dEFkZHJlc3N9YFxuICAgIGNvbnN0IHN1YnNjcmlwdGlvbnMgPSBbc3Vic2NyaXB0aW9uXVxuICAgIGNvbnN0IHN0YXRlID0gZmVlZC5pbml0KClcbiAgICBmZWVkLmFkZHJlc3MgPSBhZGRyZXNzXG5cbiAgICBhY3RpdmVbYWRkcmVzc10gPSB7IGZlZWQsIHN1YnNjcmlwdGlvbnMsIHN0YXRlIH1cbiAgfSBlbHNlIHtcbiAgICBzZXJ2aWNlLnN1YnNjcmlwdGlvbnMucHVzaChzdWJzY3JpcHRpb24pXG4gIH1cblxuICByZXR1cm4gc2VydmljZXNcbn1cblxuY29uc3QgZXhlY3R1ZVNlcnZpY2VzID0gPGE+KHNlcnZpY2VzOiBTZXJ2aWNlczxhPiwgc2VuZDogQWRkcmVzczxhPikgPT4ge1xuICBmb3IgKGxldCBhZGRyZXNzIGluIHNlcnZpY2VzLmFjdGl2ZSkge1xuICAgIGV4ZWN0dWVTZXJ2aWNlKHNlcnZpY2VzLmFjdGl2ZVthZGRyZXNzXSwgc2VuZClcbiAgfVxufVxuXG5jb25zdCBleGVjdHVlU2VydmljZSA9IDxhPihzZXJ2aWNlOiBTZXJ2aWNlPGEsICosICo+LCBzZW5kOiBBZGRyZXNzPGE+KSA9PiB7XG4gIGNvbnN0IHsgc3RhdGUsIGZlZWQsIHN1YnNjcmlwdGlvbnMgfSA9IHNlcnZpY2VcbiAgY29uc3QgW21vZGVsLCBmeF0gPSBmZWVkLnVwZGF0ZShzdGF0ZSwgZmVlZC5zdWJzY3JpYmUoc3Vic2NyaXB0aW9ucykpXG4gIHNlcnZpY2Uuc3RhdGUgPSBtb2RlbFxuICBmeC5leGVjdXRlKHNlbmQpXG59XG4iXX0=
(function (global, factory) {
  if (typeof define === "function" && define.amd) {
    define(["exports", "./driver"], factory);
  } else if (typeof exports !== "undefined") {
    factory(exports, require("./driver"));
  } else {
    var mod = {
      exports: {}
    };
    factory(mod.exports, global.driver);
    global.dom = mod.exports;
  }
})(this, function (exports, _driver) {
  "use strict";

  Object.defineProperty(exports, "__esModule", {
    value: true
  });
  exports.thunk = exports.node = exports.text = exports.root = exports.LazyNode = undefined;


  let driver = null;

  const absent = new String("absent");

  class Root {
    constructor(view, model, address) {
      _initialiseProps.call(this);

      this.view = view;
      this.model = model;
      this.address = address;
    }
    renderWith(current) {
      let exception = absent;
      const previous = driver;
      driver = current;

      try {
        driver.render(this.view(this.model, this.address));
      } catch (error) {
        exception = error;
      }

      driver = previous;

      if (exception != absent) {
        throw exception;
      }
    }

  }

  var _initialiseProps = function () {
    this.$type = "VirtualRoot";
  };

  class LazyNode {
    constructor(tagName, properties, children) {
      this.$type = "LazyTree";

      this.tagName = tagName;
      this.properties = properties;
      this.children = children;
      this.key = properties == null ? null : properties.key;
    }
    force() {
      if (driver == null) {
        throw TypeError("LazyTree may only be forced from with in the Root.renderWith(driver) call");
      }

      return driver.node(this.tagName, this.properties, this.children);
    }

  }

  exports.LazyNode = LazyNode;
  class LazyThunk {
    constructor(key, view, ...args) {
      this.$type = "LazyTree";

      this.key = key;
      this.view = view;
      this.args = args;
    }
    force() {
      if (driver == null) {
        throw TypeError("LazyTree may only be forced from with in the Root.renderWith(driver) call");
      }

      return driver.thunk(this.key, this.view, ...this.args);
    }

  }

  const root = exports.root = (view, model, address) => new Root(view, model, address);

  const text = exports.text = content => driver == null ? content : driver.text(content);

  const node = exports.node = (tagName, properties, children) => driver == null ? new LazyNode(tagName, properties, children) : driver.node(tagName, properties, children);

  const thunk = exports.thunk = (key, view, a0, a1, a2, a3, a4, a5, a6, a7, a8, a9) => driver == null ? new LazyThunk(key, view, a0, a1, a2, a3, a4, a5, a6, a7, a8, a9) : driver.thunk(key, view, a0, a1, a2, a3, a4, a5, a6, a7, a8, a9);
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9kb20uanMiXSwibmFtZXMiOlsiZHJpdmVyIiwiYWJzZW50IiwiU3RyaW5nIiwiUm9vdCIsImNvbnN0cnVjdG9yIiwidmlldyIsIm1vZGVsIiwiYWRkcmVzcyIsInJlbmRlcldpdGgiLCJjdXJyZW50IiwiZXhjZXB0aW9uIiwicHJldmlvdXMiLCJyZW5kZXIiLCJlcnJvciIsIiR0eXBlIiwiTGF6eU5vZGUiLCJ0YWdOYW1lIiwicHJvcGVydGllcyIsImNoaWxkcmVuIiwia2V5IiwiZm9yY2UiLCJUeXBlRXJyb3IiLCJub2RlIiwiTGF6eVRodW5rIiwiYXJncyIsInRodW5rIiwicm9vdCIsInRleHQiLCJjb250ZW50IiwiYTAiLCJhMSIsImEyIiwiYTMiLCJhNCIsImE1IiwiYTYiLCJhNyIsImE4IiwiYTkiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQXFCQSxNQUFJQSxTQUFrQixJQUF0Qjs7QUFDQSxRQUFNQyxTQUFTLElBQUlDLE1BQUosQ0FBVyxRQUFYLENBQWY7O0FBRUEsUUFBTUMsSUFBTixDQUFpRDtBQUMvQ0MsZ0JBQ0VDLElBREYsRUFFRUMsS0FGRixFQUdFQyxPQUhGLEVBSUU7QUFBQTs7QUFDQSxXQUFLRixJQUFMLEdBQVlBLElBQVo7QUFDQSxXQUFLQyxLQUFMLEdBQWFBLEtBQWI7QUFDQSxXQUFLQyxPQUFMLEdBQWVBLE9BQWY7QUFDRDtBQUNEQyxlQUFXQyxPQUFYLEVBQTRCO0FBQzFCLFVBQUlDLFlBQTRCVCxNQUFoQztBQUNBLFlBQU1VLFdBQVdYLE1BQWpCO0FBQ0FBLGVBQVNTLE9BQVQ7O0FBRUEsVUFBSTtBQUNGVCxlQUFPWSxNQUFQLENBQWMsS0FBS1AsSUFBTCxDQUFVLEtBQUtDLEtBQWYsRUFBc0IsS0FBS0MsT0FBM0IsQ0FBZDtBQUNELE9BRkQsQ0FFRSxPQUFPTSxLQUFQLEVBQWM7QUFDZEgsb0JBQVlHLEtBQVo7QUFDRDs7QUFFRGIsZUFBU1csUUFBVDs7QUFFQSxVQUFJRCxhQUFhVCxNQUFq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QUFwRCxFQUF3REMsRUFBeEQsRUFBNERDLEVBQTVELENBaEJDIiwiZmlsZSI6ImRvbS5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qIEBmbG93ICovXG5cbmltcG9ydCB7XG4gIFByb3BlcnR5RGljdGlvbmFyeSxcbiAgTGF6eVRyZWUsXG4gIFZpcnR1YWxSb290LFxuICBEcml2ZXIsXG4gIFZpcnR1YWxUZXh0LFxuICBWaXJ0dWFsTm9kZSxcbiAgVGh1bmssXG4gIFdpZGdldFxufSBmcm9tIFwiLi9kcml2ZXJcIlxuXG5pbXBvcnQgdHlwZSB7IEFkZHJlc3MsIFZpcnR1YWxUcmVlIH0gZnJvbSBcIi4vZHJpdmVyXCJcbmV4cG9ydCB0eXBlIERPTSA9IFZpcnR1YWxUcmVlXG5cbmV4cG9ydCB0eXBlIFJvb3RWaWV3PG1vZGVsLCBhY3Rpb24+ID0gKFxuICBtb2RlbDogbW9kZWwsXG4gIGFkZHJlc3M6IEFkZHJlc3M8YWN0aW9uPlxuKSA9PiBWaXJ0dWFsVHJlZVxuXG5sZXQgZHJpdmVyOiA/RHJpdmVyID0gbnVsbFxuY29uc3QgYWJzZW50ID0gbmV3IFN0cmluZyhcImFic2VudFwiKVxuXG5jbGFzcyBSb290PHN0YXRlLCBhY3Rpb24+IGltcGxlbWVudHMgVmlydHVhbFJvb3Qge1xuICBjb25zdHJ1Y3RvcihcbiAgICB2aWV3OiAobW9kZWw6IHN0YXRlLCBhZGRyZXNzOiBBZGRyZXNzPGFjdGlvbj4pID0+IERPTSxcbiAgICBtb2RlbDogc3RhdGUsXG4gICAgYWRkcmVzczogQWRkcmVzczxhY3Rpb24+XG4gICkge1xuICAgIHRoaXMudmlldyA9IHZpZXdcbiAgICB0aGlzLm1vZGVsID0gbW9kZWxcbiAgICB0aGlzLmFkZHJlc3MgPSBhZGRyZXNzXG4gIH1cbiAgcmVuZGVyV2l0aChjdXJyZW50OiBEcml2ZXIpIHtcbiAgICBsZXQgZXhjZXB0aW9uOiBFcnJvciB8IFN0cmluZyA9IGFic2VudFxuICAgIGNvbnN0IHByZXZpb3VzID0gZHJpdmVyXG4gICAgZHJpdmVyID0gY3VycmVudFxuXG4gICAgdHJ5IHtcbiAgICAgIGRyaXZlci5yZW5kZXIodGhpcy52aWV3KHRoaXMubW9kZWwsIHRoaXMuYWRkcmVzcykpXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGV4Y2VwdGlvbiA9IGVycm9yXG4gICAgfVxuXG4gICAgZHJpdmVyID0gcHJldmlvdXNcblxuICAgIGlmIChleGNlcHRpb24gIT0gYWJzZW50KSB7XG4gICAgICB0aHJvdyBleGNlcHRpb25cbiAgICB9XG4gIH1cblxuICAkdHlwZTogXCJWaXJ0dWFsUm9vdFwiID0gXCJWaXJ0dWFsUm9vdFwiXG4gIHZpZXc6IChtb2RlbDogc3RhdGUsIGFkZHJlc3M6IEFkZHJlc3M8YWN0aW9uPikgPT4gRE9NXG4gIG1vZGVsOiBzdGF0ZVxuICBhZGRyZXNzOiBBZGRyZXNzPGFjdGlvbj5cbn1cblxuZXhwb3J0IGNsYXNzIExhenlOb2RlIGltcGxlbWVudHMgTGF6eVRyZWU8VmlydHVhbE5vZGU+IHtcbiAgY29uc3RydWN0b3IoXG4gICAgdGFnTmFtZTogc3RyaW5nLFxuICAgIHByb3BlcnRpZXM6ID9Qcm9wZXJ0eURpY3Rpb25hcnksXG4gICAgY2hpbGRyZW46ID9BcnJheTxET00+XG4gICkge1xuICAgIHRoaXMudGFnTmFtZSA9IHRhZ05hbWVcbiAgICB0aGlzLnByb3BlcnRpZXMgPSBwcm9wZXJ0aWVzXG4gICAgdGhpcy5jaGlsZHJlbiA9IGNoaWxkcmVuXG4gICAgdGhpcy5rZXkgPSBwcm9wZXJ0aWVzID09IG51bGwgPyBudWxsIDogcHJvcGVydGllcy5rZXlcbiAgfVxuICBmb3JjZSgpOiBWaXJ0dWFsTm9kZSB7XG4gICAgaWYgKGRyaXZlciA9PSBudWxsKSB7XG4gICAgICB0aHJvdyBUeXBlRXJyb3IoXG4gICAgICAgIFwiTGF6eVRyZWUgbWF5IG9ubHkgYmUgZm9yY2VkIGZyb20gd2l0aCBpbiB0aGUgUm9vdC5yZW5kZXJXaXRoKGRyaXZlcikgY2FsbFwiXG4gICAgICApXG4gICAgfVxuXG4gICAgcmV0dXJuIGRyaXZlci5ub2RlKHRoaXMudGFnTmFtZSwgdGhpcy5wcm9wZXJ0aWVzLCB0aGlzLmNoaWxkcmVuKVxuICB9XG5cbiAgJHR5cGU6IFwiTGF6eVRyZWVcIiA9IFwiTGF6eVRyZWVcIlxuXG4gIHRhZ05hbWU6IHN0cmluZ1xuICBwcm9wZXJ0aWVzOiA/UHJvcGVydHlEaWN0aW9uYXJ5XG4gIGNoaWxkcmVuOiA/QXJyYXk8RE9NPlxuICBrZXk6ID9zdHJpbmdcbiAgbmFtZXNwYWNlOiBzdHJpbmdcbn1cblxuY2xhc3MgTGF6eVRodW5rIGltcGxlbWVudHMgTGF6eVRyZWU8VGh1bms+IHtcbiAgY29uc3RydWN0b3Ioa2V5OiBzdHJpbmcsIHZpZXc6IEZ1bmN0aW9uLCAuLi5hcmdzOiBBcnJheTxhbnk+KSB7XG4gICAgdGhpcy5rZXkgPSBrZXlcbiAgICB0aGlzLnZpZXcgPSB2aWV3XG4gICAgdGhpcy5hcmdzID0gYXJnc1xuICB9XG4gIGZvcmNlKCk6IFRodW5rIHtcbiAgICBpZiAoZHJpdmVyID09IG51bGwpIHtcbiAgICAgIHRocm93IFR5cGVFcnJvcihcbiAgICAgICAgXCJMYXp5VHJlZSBtYXkgb25seSBiZSBmb3JjZWQgZnJvbSB3aXRoIGluIHRoZSBSb290LnJlbmRlcldpdGgoZHJpdmVyKSBjYWxsXCJcbiAgICAgIClcbiAgICB9XG5cbiAgICByZXR1cm4gZHJpdmVyLnRodW5rKHRoaXMua2V5LCB0aGlzLnZpZXcsIC4uLnRoaXMuYXJncylcbiAgfVxuXG4gICR0eXBlOiBcIkxhenlUcmVlXCIgPSBcIkxhenlUcmVlXCJcblxuICBrZXk6IHN0cmluZ1xuICB2aWV3OiBGdW5jdGlvblxuICBhcmdzOiBBcnJheTxhbnk+XG59XG5cbmV4cG9ydCBjb25zdCByb290ID0gPHN0YXRlLCBhY3Rpb24+KFxuICB2aWV3OiAobW9kZWw6IHN0YXRlLCBhZGRyZXNzOiBBZGRyZXNzPGFjdGlvbj4pID0+IERPTSxcbiAgbW9kZWw6IHN0YXRlLFxuICBhZGRyZXNzOiBBZGRyZXNzPGFjdGlvbj5cbik6IFZpcnR1YWxSb290ID0+IG5ldyBSb290KHZpZXcsIG1vZGVsLCBhZGRyZXNzKVxuXG5leHBvcnQgY29uc3QgdGV4dCA9IChjb250ZW50OiBzdHJpbmcpOiBWaXJ0dWFsVGV4dCA9PlxuICBkcml2ZXIgPT0gbnVsbCA/IChjb250ZW50OiBhbnkpIDogZHJpdmVyLnRleHQoY29udGVudClcblxuZXhwb3J0IGNvbnN0IG5vZGUgPSAoXG4gIHRhZ05hbWU6IHN0cmluZyxcbiAgcHJvcGVydGllczogP1Byb3BlcnR5RGljdGlvbmFyeSxcbiAgY2hpbGRyZW46ID9BcnJheTxET00+XG4pOiBWaXJ0dWFsTm9kZSB8IExhenlUcmVlPFZpcnR1YWxOb2RlPiA9PlxuICBkcml2ZXIgPT0gbnVsbFxuICAgID8gbmV3IExhenlOb2RlKHRhZ05hbWUsIHByb3BlcnRpZXMsIGNoaWxkcmVuKVxuICAgIDogZHJpdmVyLm5vZGUodGFnTmFtZSwgcHJvcGVydGllcywgY2hpbGRyZW4pXG5cbmV4cG9ydCBjb25zdCB0aHVuayA9IDxhLCBiLCBjLCBkLCBlLCBmLCBnLCBoLCBpLCBqPihcbiAga2V5OiBzdHJpbmcsXG4gIHZpZXc6IChhOiBhLCBiOiBiLCBjOiBjLCBkOiBkLCBlOiBlLCBmOiBmLCBnOiBnLCBoOiBoLCBpOiBpLCBqOiBqKSA9PiBET00sXG4gIGEwOiBhLFxuICBhMTogYixcbiAgYTI6IGMsXG4gIGEzOiBkLFxuICBhNDogZSxcbiAgYTU6IGYsXG4gIGE2OiBnLFxuICBhNzogaCxcbiAgYTg6IGksXG4gIGE5OiBqXG4pOiBUaHVuayB8IExhenlUcmVlPFRodW5rPiA9PlxuICBkcml2ZXIgPT0gbnVsbFxuICAgID8gbmV3IExhenlUaHVuayhrZXksIHZpZXcsIGEwLCBhMSwgYTIsIGEzLCBhNCwgYTUsIGE2LCBhNywgYTgsIGE5KVxuICAgIDogZHJpdmVyLnRodW5rKGtleSwgdmlldywgYTAsIGExLCBhMiwgYTMsIGE0LCBhNSwgYTYsIGE3LCBhOCwgYTkpXG4iXX0=
(function (global, factory) {
  if (typeof define === "function" && define.amd) {
    define([], factory);
  } else if (typeof exports !== "undefined") {
    factory();
  } else {
    var mod = {
      exports: {}
    };
    factory();
    global.driver = mod.exports;
  }
})(this, function () {
  "use strict";
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJkcml2ZXIuanMiLCJzb3VyY2VzQ29udGVudCI6W119
(function (global, factory) {
  if (typeof define === "function" && define.amd) {
    define(["exports", "./task"], factory);
  } else if (typeof exports !== "undefined") {
    factory(exports, require("./task"));
  } else {
    var mod = {
      exports: {}
    };
    factory(mod.exports, global.task);
    global.effects = mod.exports;
  }
})(this, function (exports, _task) {
  "use strict";

  Object.defineProperty(exports, "__esModule", {
    value: true
  });
  exports.Effects = undefined;


  const raise = error => {
    throw Error(`Effects should be created from task that never fail but it did fail with error ${error}`);
  };

  const ignore = _ => void 0;

  const nil = _task.Task.succeed(void 0);

  const never = new _task.Task((succeed, fail) => void 0);

  class Effects {
    static task(task) {
      console.warn("Effects.task is deprecated please use Effects.perform instead");
      return new Perform(task);
    }
    static perform(task) {
      return new Perform(task);
    }
    static tick(tag) {
      console.warn("Effects.tick is deprecated please use Effects.perform(Task.requestAnimationFrame().map(tag)) instead");
      return new Perform(_task.Task.requestAnimationFrame().map(tag));
    }
    static receive(action) {
      const fx = new Perform(new _task.Task((succeed, fail) => void Promise.resolve(action).then(succeed, fail)));
      return fx;
    }
    static batch(effects) {
      return new Batch(effects);
    }
    map(f) {
      throw Error("Subclass of abstract Effect must implement map");
    }
    execute(address) {
      throw Error("Subclass of abstract Effect must implement execute");
    }
  }

  exports.Effects = Effects;
  class Perform extends Effects {
    constructor(task) {
      super();
      this.task = task;
    }
    map(f) {
      return new Perform(this.task.map(f));
    }
    execute(address) {
      return this.task.chain(value => _task.Task.send(address, value));
    }
  }

  class None extends Effects {
    map(f) {
      return Effects.none;
    }
    execute(address) {
      return nil;
    }
  }
  Effects.none = new None();

  class Batch extends Effects {
    constructor(effects) {
      super();
      this.effects = effects;
    }
    map(f) {
      return new Batch(this.effects.map(effect => effect.map(f)));
    }
    execute(address) {
      return new _task.Task((succeed, fail) => {
        const { effects } = this;
        const count = effects.length;
        let index = 0;
        while (index < count) {
          const effect = effects[index];
          if (!(effect instanceof None)) {
            _task.Task.fork(effect.execute(address), ignore, raise);
          }

          index = index + 1;
        }
        succeed(void 0);
      });
    }

  }
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9lZmZlY3RzLmpzIl0sIm5hbWVzIjpbInJhaXNlIiwiZXJyb3IiLCJFcnJvciIsImlnbm9yZSIsIl8iLCJuaWwiLCJzdWNjZWVkIiwibmV2ZXIiLCJmYWlsIiwiRWZmZWN0cyIsInRhc2siLCJjb25zb2xlIiwid2FybiIsIlBlcmZvcm0iLCJwZXJmb3JtIiwidGljayIsInRhZyIsInJlcXVlc3RBbmltYXRpb25GcmFtZSIsIm1hcCIsInJlY2VpdmUiLCJhY3Rpb24iLCJmeCIsIlByb21pc2UiLCJyZXNvbHZlIiwidGhlbiIsImJhdGNoIiwiZWZmZWN0cyIsIkJhdGNoIiwiZiIsImV4ZWN1dGUiLCJhZGRyZXNzIiwiY29uc3RydWN0b3IiLCJjaGFpbiIsInZhbHVlIiwic2VuZCIsIk5vbmUiLCJub25lIiwiZWZmZWN0IiwiY291bnQiLCJsZW5ndGgiLCJpbmRleCIsImZvcmsiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQVVBLFFBQU1BLFFBQVFDLFNBQVM7QUFDckIsVUFBTUMsTUFDSCxrRkFBaUZELEtBQU0sRUFEcEYsQ0FBTjtBQUdELEdBSkQ7O0FBTUEsUUFBTUUsU0FBU0MsS0FBSyxLQUFLLENBQXpCOztBQUVBLFFBQU1DLE1BQU0sV0FBS0MsT0FBTCxDQUFhLEtBQUssQ0FBbEIsQ0FBWjs7QUFFQSxRQUFNQyxRQUFRLGVBQVMsQ0FBQ0QsT0FBRCxFQUFVRSxJQUFWLEtBQW1CLEtBQUssQ0FBakMsQ0FBZDs7QUFFTyxRQUFNQyxPQUFOLENBQWlCO0FBQ3RCLFdBQU9DLElBQVAsQ0FBZUEsSUFBZixFQUFpRDtBQUMvQ0MsY0FBUUMsSUFBUixDQUNFLCtEQURGO0FBR0EsYUFBTyxJQUFJQyxPQUFKLENBQVlILElBQVosQ0FBUDtBQUNEO0FBQ0QsV0FBT0ksT0FBUCxDQUFrQkosSUFBbEIsRUFBb0Q7QUFDbEQsYUFBTyxJQUFJRyxPQUFKLENBQVlILElBQVosQ0FBUDtBQUNEO0FBQ0QsV0FBT0ssSUFBUCxDQUFlQyxHQUFmLEVBQXFEO0FBQ25ETCxjQUFRQyxJQUFSLENBQ0Usc0dBREY7QUFHQSxhQUFPLElBQUlDLE9BQUosQ0FBWSxXQUFLSSxxQkFBTCxHQUE2QkMsR0FBN0IsQ0FBaUNGLEdBQWpDLENBQVosQ0FBUDtBQUNEO0FBQ0QsV0FBT0csT0FBUCxDQUFrQkMsTUFBbEIsRUFBeUM7QUFDdkMsWUFBTUMsS0FBSyxJQUFJUixPQUFKLENBQ1QsZUFDRSxDQUFDUCxPQUFELEVBQVVFLElBQVYsS0FBbUIsS0FBS2MsUUFBUUMsT0FBUixDQUFnQkgsTUFBaEIsRUFBd0JJLElBQXhCLENBQTZCbEIsT0FBN0IsRUFBc0NFLElBQXRDLENBRDFCLENBRFMsQ0FBWDtBQUtBLGFBQU9hLEVBQVA7QUFDRDtBQUNELFdBQU9JLEtBQVAsQ0FBZ0JDLE9BQWhCLEVBQXdEO0FBQ3RELGFBQU8sSUFBSUMsS0FBSixDQUFVRCxPQUFWLENBQVA7QUFDRDtBQUNEUixRQUFPVSxDQUFQLEVBQW1DO0FBQ2pDLFlBQU0xQixNQUFNLGdEQUFOLENBQU47QUFDRDtBQUNEMkIsWUFBUUMsT0FBUixFQUFnRDtBQUM5QyxZQUFNNUIsTUFBTSxvREFBTixDQUFOO0FBQ0Q7QUFoQ3FCOztVQUFYTyxPLEdBQUFBLE87QUFxQ2IsUUFBTUksT0FBTixTQUF5QkosT0FBekIsQ0FBb0M7QUFDbENzQixnQkFBWXJCLElBQVosRUFBa0M7QUFDaEM7QUFDQSxXQUFLQSxJQUFMLEdBQVlBLElBQVo7QUFDRDtBQUNEUSxRQUFPVSxDQUFQLEVBQW1DO0FBQ2pDLGFBQU8sSUFBSWYsT0FBSixDQUFZLEtBQUtILElBQUwsQ0FBVVEsR0FBVixDQUFjVSxDQUFkLENBQVosQ0FBUDtBQUNEO0FBQ0RDLFlBQVFDLE9BQVIsRUFBZ0Q7QUFDOUMsYUFBTyxLQUFLcEIsSUFBTCxDQUFVc0IsS0FBVixDQUFnQkMsU0FBUyxXQUFLQyxJQUFMLENBQVVKLE9BQVYsRUFBbUJHLEtBQW5CLENBQXpCLENBQVA7QUFDRDtBQVZpQzs7QUFhcEMsUUFBTUUsSUFBTixTQUFzQjFCLE9BQXRCLENBQW1DO0FBQ2pDUyxRQUFPVSxDQUFQLEVBQW1DO0FBQ2pDLGFBQU9uQixRQUFRMkIsSUFBZjtBQUNEO0FBQ0RQLFlBQVFDLE9BQVIsRUFBZ0Q7QUFDOUMsYUFBT3pCLEdBQVA7QUFDRDtBQU5nQztBQVFuQ0ksVUFBUTJCLElBQVIsR0FBZSxJQUFJRCxJQUFKLEVBQWY7O0FBRUEsUUFBTVIsS0FBTixTQUF1QmxCLE9BQXZCLENBQWtDO0FBQ2hDc0IsZ0JBQVlMLE9BQVosRUFBd0M7QUFDdEM7QUFDQSxXQUFLQSxPQUFMLEdBQWVBLE9BQWY7QUFDRDtBQUNEUixRQUFPVSxDQUFQLEVBQW1DO0FBQ2pDLGFBQU8sSUFBSUQsS0FBSixDQUFVLEtBQUtELE9BQUwsQ0FBYVIsR0FBYixDQUFpQm1CLFVBQVVBLE9BQU9uQixHQUFQLENBQVdVLENBQVgsQ0FBM0IsQ0FBVixDQUFQO0FBQ0Q7QUFDREMsWUFBUUMsT0FBUixFQUFnRDtBQUM5QyxhQUFPLGVBQVMsQ0FBQ3hCLE9BQUQsRUFBVUUsSUFBVixLQUFtQjtBQUNqQyxjQUFNLEVBQUVrQixPQUFGLEtBQWMsSUFBcEI7QUFDQSxjQUFNWSxRQUFRWixRQUFRYSxNQUF0QjtBQUNBLFlBQUlDLFFBQVEsQ0FBWjtBQUNBLGVBQU9BLFFBQVFGLEtBQWYsRUFBc0I7QUFDcEIsZ0JBQU1ELFNBQVNYLFFBQVFjLEtBQVIsQ0FBZjtBQUNBLGNBQUksRUFBRUgsa0JBQWtCRixJQUFwQixDQUFKLEVBQStCO0FBQzdCLHVCQUFLTSxJQUFMLENBQVVKLE9BQU9SLE9BQVAsQ0FBZUMsT0FBZixDQUFWLEVBQW1DM0IsTUFBbkMsRUFBMkNILEtBQTNDO0FBQ0Q7O0FBRUR3QyxrQkFBUUEsUUFBUSxDQUFoQjtBQUNEO0FBQ0RsQyxnQkFBUSxLQUFLLENBQWI7QUFDRCxPQWJNLENBQVA7QUFjRDs7QUF2QitCIiwiZmlsZSI6ImVmZmVjdHMuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKiBAZmxvdyAqL1xuXG5pbXBvcnQgeyBUYXNrIH0gZnJvbSBcIi4vdGFza1wiXG5cbmltcG9ydCB0eXBlIHsgQWRkcmVzcyB9IGZyb20gXCIuL2RyaXZlclwiXG5cbmV4cG9ydCB0eXBlIFRpbWUgPSBudW1iZXJcblxuZXhwb3J0IHR5cGUgTmV2ZXIgPSBudW1iZXIgJiBzdHJpbmdcblxuY29uc3QgcmFpc2UgPSBlcnJvciA9PiB7XG4gIHRocm93IEVycm9yKFxuICAgIGBFZmZlY3RzIHNob3VsZCBiZSBjcmVhdGVkIGZyb20gdGFzayB0aGF0IG5ldmVyIGZhaWwgYnV0IGl0IGRpZCBmYWlsIHdpdGggZXJyb3IgJHtlcnJvcn1gXG4gIClcbn1cblxuY29uc3QgaWdub3JlID0gXyA9PiB2b2lkIDBcblxuY29uc3QgbmlsID0gVGFzay5zdWNjZWVkKHZvaWQgMClcblxuY29uc3QgbmV2ZXIgPSBuZXcgVGFzaygoc3VjY2VlZCwgZmFpbCkgPT4gdm9pZCAwKVxuXG5leHBvcnQgY2xhc3MgRWZmZWN0czxhPiB7XG4gIHN0YXRpYyB0YXNrPGE+KHRhc2s6IFRhc2s8TmV2ZXIsIGE+KTogRWZmZWN0czxhPiB7XG4gICAgY29uc29sZS53YXJuKFxuICAgICAgXCJFZmZlY3RzLnRhc2sgaXMgZGVwcmVjYXRlZCBwbGVhc2UgdXNlIEVmZmVjdHMucGVyZm9ybSBpbnN0ZWFkXCJcbiAgICApXG4gICAgcmV0dXJuIG5ldyBQZXJmb3JtKHRhc2spXG4gIH1cbiAgc3RhdGljIHBlcmZvcm08YT4odGFzazogVGFzazxOZXZlciwgYT4pOiBFZmZlY3RzPGE+IHtcbiAgICByZXR1cm4gbmV3IFBlcmZvcm0odGFzaylcbiAgfVxuICBzdGF0aWMgdGljazxhPih0YWc6ICh0aW1lOiBudW1iZXIpID0+IGEpOiBFZmZlY3RzPGE+IHtcbiAgICBjb25zb2xlLndhcm4oXG4gICAgICBcIkVmZmVjdHMudGljayBpcyBkZXByZWNhdGVkIHBsZWFzZSB1c2UgRWZmZWN0cy5wZXJmb3JtKFRhc2sucmVxdWVzdEFuaW1hdGlvbkZyYW1lKCkubWFwKHRhZykpIGluc3RlYWRcIlxuICAgIClcbiAgICByZXR1cm4gbmV3IFBlcmZvcm0oVGFzay5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKS5tYXAodGFnKSlcbiAgfVxuICBzdGF0aWMgcmVjZWl2ZTxhPihhY3Rpb246IGEpOiBFZmZlY3RzPGE+IHtcbiAgICBjb25zdCBmeCA9IG5ldyBQZXJmb3JtKFxuICAgICAgbmV3IFRhc2soXG4gICAgICAgIChzdWNjZWVkLCBmYWlsKSA9PiB2b2lkIFByb21pc2UucmVzb2x2ZShhY3Rpb24pLnRoZW4oc3VjY2VlZCwgZmFpbClcbiAgICAgIClcbiAgICApXG4gICAgcmV0dXJuIGZ4XG4gIH1cbiAgc3RhdGljIGJhdGNoPGE+KGVmZmVjdHM6IEFycmF5PEVmZmVjdHM8YT4+KTogRWZmZWN0czxhPiB7XG4gICAgcmV0dXJuIG5ldyBCYXRjaChlZmZlY3RzKVxuICB9XG4gIG1hcDxiPihmOiAoYTogYSkgPT4gYik6IEVmZmVjdHM8Yj4ge1xuICAgIHRocm93IEVycm9yKFwiU3ViY2xhc3Mgb2YgYWJzdHJhY3QgRWZmZWN0IG11c3QgaW1wbGVtZW50IG1hcFwiKVxuICB9XG4gIGV4ZWN1dGUoYWRkcmVzczogQWRkcmVzczxhPik6IFRhc2s8TmV2ZXIsIHZvaWQ+IHtcbiAgICB0aHJvdyBFcnJvcihcIlN1YmNsYXNzIG9mIGFic3RyYWN0IEVmZmVjdCBtdXN0IGltcGxlbWVudCBleGVjdXRlXCIpXG4gIH1cbiAgc3RhdGljIG5vbmU6IEVmZmVjdHM8YW55PlxuICB0YXNrOiBUYXNrPE5ldmVyLCBhPlxufVxuXG5jbGFzcyBQZXJmb3JtPGE+IGV4dGVuZHMgRWZmZWN0czxhPiB7XG4gIGNvbnN0cnVjdG9yKHRhc2s6IFRhc2s8TmV2ZXIsIGE+KSB7XG4gICAgc3VwZXIoKVxuICAgIHRoaXMudGFzayA9IHRhc2tcbiAgfVxuICBtYXA8Yj4oZjogKGE6IGEpID0+IGIpOiBFZmZlY3RzPGI+IHtcbiAgICByZXR1cm4gbmV3IFBlcmZvcm0odGhpcy50YXNrLm1hcChmKSlcbiAgfVxuICBleGVjdXRlKGFkZHJlc3M6IEFkZHJlc3M8YT4pOiBUYXNrPE5ldmVyLCB2b2lkPiB7XG4gICAgcmV0dXJuIHRoaXMudGFzay5jaGFpbih2YWx1ZSA9PiBUYXNrLnNlbmQoYWRkcmVzcywgdmFsdWUpKVxuICB9XG59XG5cbmNsYXNzIE5vbmU8YT4gZXh0ZW5kcyBFZmZlY3RzPGFueT4ge1xuICBtYXA8Yj4oZjogKGE6IGEpID0+IGIpOiBFZmZlY3RzPGI+IHtcbiAgICByZXR1cm4gRWZmZWN0cy5ub25lXG4gIH1cbiAgZXhlY3V0ZShhZGRyZXNzOiBBZGRyZXNzPGE+KTogVGFzazxOZXZlciwgdm9pZD4ge1xuICAgIHJldHVybiBuaWxcbiAgfVxufVxuRWZmZWN0cy5ub25lID0gbmV3IE5vbmUoKVxuXG5jbGFzcyBCYXRjaDxhPiBleHRlbmRzIEVmZmVjdHM8YT4ge1xuICBjb25zdHJ1Y3RvcihlZmZlY3RzOiBBcnJheTxFZmZlY3RzPGE+Pikge1xuICAgIHN1cGVyKClcbiAgICB0aGlzLmVmZmVjdHMgPSBlZmZlY3RzXG4gIH1cbiAgbWFwPGI+KGY6IChhOiBhKSA9PiBiKTogRWZmZWN0czxiPiB7XG4gICAgcmV0dXJuIG5ldyBCYXRjaCh0aGlzLmVmZmVjdHMubWFwKGVmZmVjdCA9PiBlZmZlY3QubWFwKGYpKSlcbiAgfVxuICBleGVjdXRlKGFkZHJlc3M6IEFkZHJlc3M8YT4pOiBUYXNrPE5ldmVyLCB2b2lkPiB7XG4gICAgcmV0dXJuIG5ldyBUYXNrKChzdWNjZWVkLCBmYWlsKSA9PiB7XG4gICAgICBjb25zdCB7IGVmZmVjdHMgfSA9IHRoaXNcbiAgICAgIGNvbnN0IGNvdW50ID0gZWZmZWN0cy5sZW5ndGhcbiAgICAgIGxldCBpbmRleCA9IDBcbiAgICAgIHdoaWxlIChpbmRleCA8IGNvdW50KSB7XG4gICAgICAgIGNvbnN0IGVmZmVjdCA9IGVmZmVjdHNbaW5kZXhdXG4gICAgICAgIGlmICghKGVmZmVjdCBpbnN0YW5jZW9mIE5vbmUpKSB7XG4gICAgICAgICAgVGFzay5mb3JrKGVmZmVjdC5leGVjdXRlKGFkZHJlc3MpLCBpZ25vcmUsIHJhaXNlKVxuICAgICAgICB9XG5cbiAgICAgICAgaW5kZXggPSBpbmRleCArIDFcbiAgICAgIH1cbiAgICAgIHN1Y2NlZWQodm9pZCAwKVxuICAgIH0pXG4gIH1cblxuICBlZmZlY3RzOiBBcnJheTxFZmZlY3RzPGE+PlxufVxuIl19
(function (global, factory) {
  if (typeof define === "function" && define.amd) {
    define(["exports", "./dom"], factory);
  } else if (typeof exports !== "undefined") {
    factory(exports, require("./dom"));
  } else {
    var mod = {
      exports: {}
    };
    factory(mod.exports, global.dom);
    global.html = mod.exports;
  }
})(this, function (exports, _dom) {
  "use strict";

  Object.defineProperty(exports, "__esModule", {
    value: true
  });
  exports.html = undefined;
  const html = exports.html = ["a", "abbr", "address", "area", "article", "aside", "audio", "b", "base", "bdi", "bdo", "big", "blockquote", "body", "br", "button", "canvas", "caption", "cite", "code", "col", "colgroup", "data", "datalist", "dd", "del", "details", "dfn", "dialog", "div", "dl", "dt", "em", "embed", "fieldset", "figcaption", "figure", "footer", "form", "h1", "h2", "h3", "h4", "h5", "h6", "head", "header", "hr", "html", "i", "iframe", "img", "input", "ins", "kbd", "keygen", "label", "legend", "li", "link", "main", "map", "mark", "menu", "menuitem", "meta", "meter", "nav", "noscript", "object", "ol", "optgroup", "option", "output", "p", "param", "picture", "pre", "progress", "q", "rp", "rt", "ruby", "s", "samp", "script", "section", "select", "small", "source", "span", "strong", "style", "sub", "summary", "sup", "table", "tbody", "td", "textarea", "tfoot", "th", "thead", "time", "title", "tr", "track", "u", "ul", "var", "video", "wbr", "circle", "clipPath", "defs", "ellipse", "g", "line", "linearGradient", "mask", "path", "pattern", "polygon", "polyline", "radialGradient", "rect", "stop", "svg", "text", "tspan"].reduce((html, tagName) => {
    const element = (properties, children) => (0, _dom.node)(tagName, properties, children);

    html[tagName] = element;
    return html;
  }, (
  // @Hack: Workarounding facebook/flow#1683
  Object.create(null), {}));
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9odG1sLmpzIl0sIm5hbWVzIjpbImh0bWwiLCJyZWR1Y2UiLCJ0YWdOYW1lIiwiZWxlbWVudCIsInByb3BlcnRpZXMiLCJjaGlsZHJlbiIsIk9iamVjdCIsImNyZWF0ZSJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQStJTyxRQUFNQSxzQkFBYSxDQUN4QixHQUR3QixFQUV4QixNQUZ3QixFQUd4QixTQUh3QixFQUl4QixNQUp3QixFQUt4QixTQUx3QixFQU14QixPQU53QixFQU94QixPQVB3QixFQVF4QixHQVJ3QixFQVN4QixNQVR3QixFQVV4QixLQVZ3QixFQVd4QixLQVh3QixFQVl4QixLQVp3QixFQWF4QixZQWJ3QixFQWN4QixNQWR3QixFQWV4QixJQWZ3QixFQWdCeEIsUUFoQndCLEVBaUJ4QixRQWpCd0IsRUFrQnhCLFNBbEJ3QixFQW1CeEIsTUFuQndCLEVBb0J4QixNQXBCd0IsRUFxQnhCLEtBckJ3QixFQXNCeEIsVUF0QndCLEVBdUJ4QixNQXZCd0IsRUF3QnhCLFVBeEJ3QixFQXlCeEIsSUF6QndCLEVBMEJ4QixLQTFCd0IsRUEyQnhCLFNBM0J3QixFQTRCeEIsS0E1QndCLEVBNkJ4QixRQTdCd0IsRUE4QnhCLEtBOUJ3QixFQStCeEIsSUEvQndCLEVBZ0N4QixJQWhDd0IsRUFpQ3hCLElBakN3QixFQWtDeEIsT0FsQ3dCLEVBbUN4QixVQW5Dd0IsRUFvQ3hCLFlBcEN3QixFQXFDeEIsUUFyQ3dCLEVBc0N4QixRQXRDd0IsRUF1Q3hCLE1BdkN3QixFQXdDeEIsSUF4Q3dCLEVBeUN4QixJQXpDd0IsRUEwQ3hCLElBMUN3QixFQTJDeEIsSUEzQ3dCLEVBNEN4QixJQTVDd0IsRUE2Q3hCLElBN0N3QixFQThDeEIsTUE5Q3dCLEVBK0N4QixRQS9Dd0IsRUFnRHhCLElBaER3QixFQWlEeEIsTUFqRHdCLEVBa0R4QixHQWxEd0IsRUFtRHhCLFFBbkR3QixFQW9EeEIsS0FwRHdCLEVBcUR4QixPQXJEd0IsRUFzRHhCLEtBdER3QixFQXVEeEIsS0F2RHdCLEVBd0R4QixRQXhEd0IsRUF5RHhCLE9BekR3QixFQTBEeEIsUUExRHdCLEVBMkR4QixJQTNEd0IsRUE0RHhCLE1BNUR3QixFQTZEeEIsTUE3RHdCLEVBOER4QixLQTlEd0IsRUErRHhCLE1BL0R3QixFQWdFeEIsTUFoRXdCLEVBaUV4QixVQWpFd0IsRUFrRXhCLE1BbEV3QixFQW1FeEIsT0FuRXdCLEVBb0V4QixLQXBFd0IsRUFxRXhCLFVBckV3QixFQXNFeEIsUUF0RXdCLEVBdUV4QixJQXZFd0IsRUF3RXhCLFVBeEV3QixFQXlFeEIsUUF6RXdCLEVBMEV4QixRQTFFd0IsRUEyRXhCLEdBM0V3QixFQTRFeEIsT0E1RXdCLEVBNkV4QixTQTdFd0IsRUE4RXhCLEtBOUV3QixFQStFeEIsVUEvRXdCLEVBZ0Z4QixHQWhGd0IsRUFpRnhCLElBakZ3QixFQWtGeEIsSUFsRndCLEVBbUZ4QixNQW5Gd0IsRUFvRnhCLEdBcEZ3QixFQXFGeEIsTUFyRndCLEVBc0Z4QixRQXRGd0IsRUF1RnhCLFNBdkZ3QixFQXdGeEIsUUF4RndCLEVBeUZ4QixPQXpGd0IsRUEwRnhCLFFBMUZ3QixFQTJGeEIsTUEzRndCLEVBNEZ4QixRQTVGd0IsRUE2RnhCLE9BN0Z3QixFQThGeEIsS0E5RndCLEVBK0Z4QixTQS9Gd0IsRUFnR3hCLEtBaEd3QixFQWlHeEIsT0FqR3dCLEVBa0d4QixPQWxHd0IsRUFtR3hCLElBbkd3QixFQW9HeEIsVUFwR3dCLEVBcUd4QixPQXJHd0IsRUFzR3hCLElBdEd3QixFQXVHeEIsT0F2R3dCLEVBd0d4QixNQXhHd0IsRUF5R3hCLE9Bekd3QixFQTBHeEIsSUExR3dCLEVBMkd4QixPQTNHd0IsRUE0R3hCLEdBNUd3QixFQTZHeEIsSUE3R3dCLEVBOEd4QixLQTlHd0IsRUErR3hCLE9BL0d3QixFQWdIeEIsS0FoSHdCLEVBaUh4QixRQWpId0IsRUFrSHhCLFVBbEh3QixFQW1IeEIsTUFuSHdCLEVBb0h4QixTQXBId0IsRUFxSHhCLEdBckh3QixFQXNIeEIsTUF0SHdCLEVBdUh4QixnQkF2SHdCLEVBd0h4QixNQXhId0IsRUF5SHhCLE1Bekh3QixFQTBIeEIsU0ExSHdCLEVBMkh4QixTQTNId0IsRUE0SHhCLFVBNUh3QixFQTZIeEIsZ0JBN0h3QixFQThIeEIsTUE5SHdCLEVBK0h4QixNQS9Id0IsRUFnSXhCLEtBaEl3QixFQWlJeEIsTUFqSXdCLEVBa0l4QixPQWxJd0IsRUFtSXhCQyxNQW5Jd0IsQ0FvSXhCLENBQUNELElBQUQsRUFBT0UsT0FBUCxLQUFtQjtBQUNqQixVQUFNQyxVQUFtQixDQUFDQyxVQUFELEVBQWFDLFFBQWIsS0FDdkIsZUFBS0gsT0FBTCxFQUFjRSxVQUFkLEVBQTBCQyxRQUExQixDQURGOztBQUdBTCxTQUFLRSxPQUFMLElBQWdCQyxPQUFoQjtBQUNBLFdBQU9ILElBQVA7QUFDRCxHQTFJdUI7QUEySXhCO0FBQ0NNLFNBQU9DLE1BQVAsQ0FBYyxJQUFkLEdBQXFCLEVBNUlFLEVBQW5CIiwiZmlsZSI6Imh0bWwuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKiBAZmxvdyAqL1xuXG5pbXBvcnQgdHlwZSB7IFZpcnR1YWxOb2RlLCBWaXJ0dWFsVHJlZSwgTGF6eVRyZWUgfSBmcm9tIFwiLi9kcml2ZXJcIlxuaW1wb3J0IHsgbm9kZSB9IGZyb20gXCIuL2RvbVwiXG5cbmV4cG9ydCB0eXBlIGVsZW1lbnQgPSAoXG4gIHByb3BlcnRpZXM6ID9PYmplY3QsXG4gIGNoaWxkcmVuOiA/QXJyYXk8VmlydHVhbFRyZWU+XG4pID0+IFZpcnR1YWxOb2RlIHwgTGF6eVRyZWU8VmlydHVhbE5vZGU+XG5cbmV4cG9ydCB0eXBlIEh0bWwgPSB7XG4gIGE6IGVsZW1lbnQsXG4gIGFiYnI6IGVsZW1lbnQsXG4gIGFkZHJlc3M6IGVsZW1lbnQsXG4gIGFyZWE6IGVsZW1lbnQsXG4gIGFydGljbGU6IGVsZW1lbnQsXG4gIGFzaWRlOiBlbGVtZW50LFxuICBhdWRpbzogZWxlbWVudCxcbiAgYjogZWxlbWVudCxcbiAgYmFzZTogZWxlbWVudCxcbiAgYmRpOiBlbGVtZW50LFxuICBiZG86IGVsZW1lbnQsXG4gIGJpZzogZWxlbWVudCxcbiAgYmxvY2txdW90ZTogZWxlbWVudCxcbiAgYm9keTogZWxlbWVudCxcbiAgYnI6IGVsZW1lbnQsXG4gIGJ1dHRvbjogZWxlbWVudCxcbiAgY2FudmFzOiBlbGVtZW50LFxuICBjYXB0aW9uOiBlbGVtZW50LFxuICBjaXRlOiBlbGVtZW50LFxuICBjb2RlOiBlbGVtZW50LFxuICBjb2w6IGVsZW1lbnQsXG4gIGNvbGdyb3VwOiBlbGVtZW50LFxuICBkYXRhOiBlbGVtZW50LFxuICBkYXRhbGlzdDogZWxlbWVudCxcbiAgZGQ6IGVsZW1lbnQsXG4gIGRlbDogZWxlbWVudCxcbiAgZGV0YWlsczogZWxlbWVudCxcbiAgZGZuOiBlbGVtZW50LFxuICBkaWFsb2c6IGVsZW1lbnQsXG4gIGRpdjogZWxlbWVudCxcbiAgZGw6IGVsZW1lbnQsXG4gIGR0OiBlbGVtZW50LFxuICBlbTogZWxlbWVudCxcbiAgZW1iZWQ6IGVsZW1lbnQsXG4gIGZpZWxkc2V0OiBlbGVtZW50LFxuICBmaWdjYXB0aW9uOiBlbGVtZW50LFxuICBmaWd1cmU6IGVsZW1lbnQsXG4gIGZvb3RlcjogZWxlbWVudCxcbiAgZm9ybTogZWxlbWVudCxcbiAgaDE6IGVsZW1lbnQsXG4gIGgyOiBlbGVtZW50LFxuICBoMzogZWxlbWVudCxcbiAgaDQ6IGVsZW1lbnQsXG4gIGg1OiBlbGVtZW50LFxuICBoNjogZWxlbWVudCxcbiAgaGVhZDogZWxlbWVudCxcbiAgaGVhZGVyOiBlbGVtZW50LFxuICBocjogZWxlbWVudCxcbiAgaHRtbDogZWxlbWVudCxcbiAgaTogZWxlbWVudCxcbiAgaWZyYW1lOiBlbGVtZW50LFxuICBpbWc6IGVsZW1lbnQsXG4gIGlucHV0OiBlbGVtZW50LFxuICBpbnM6IGVsZW1lbnQsXG4gIGtiZDogZWxlbWVudCxcbiAga2V5Z2VuOiBlbGVtZW50LFxuICBsYWJlbDogZWxlbWVudCxcbiAgbGVnZW5kOiBlbGVtZW50LFxuICBsaTogZWxlbWVudCxcbiAgbGluazogZWxlbWVudCxcbiAgbWFpbjogZWxlbWVudCxcbiAgbWFwOiBlbGVtZW50LFxuICBtYXJrOiBlbGVtZW50LFxuICBtZW51OiBlbGVtZW50LFxuICBtZW51aXRlbTogZWxlbWVudCxcbiAgbWV0YTogZWxlbWVudCxcbiAgbWV0ZXI6IGVsZW1lbnQsXG4gIG5hdjogZWxlbWVudCxcbiAgbm9zY3JpcHQ6IGVsZW1lbnQsXG4gIG9iamVjdDogZWxlbWVudCxcbiAgb2w6IGVsZW1lbnQsXG4gIG9wdGdyb3VwOiBlbGVtZW50LFxuICBvcHRpb246IGVsZW1lbnQsXG4gIG91dHB1dDogZWxlbWVudCxcbiAgcDogZWxlbWVudCxcbiAgcGFyYW06IGVsZW1lbnQsXG4gIHBpY3R1cmU6IGVsZW1lbnQsXG4gIHByZTogZWxlbWVudCxcbiAgcHJvZ3Jlc3M6IGVsZW1lbnQsXG4gIHE6IGVsZW1lbnQsXG4gIHJwOiBlbGVtZW50LFxuICBydDogZWxlbWVudCxcbiAgcnVieTogZWxlbWVudCxcbiAgczogZWxlbWVudCxcbiAgc2FtcDogZWxlbWVudCxcbiAgc2NyaXB0OiBlbGVtZW50LFxuICBzZWN0aW9uOiBlbGVtZW50LFxuICBzZWxlY3Q6IGVsZW1lbnQsXG4gIHNtYWxsOiBlbGVtZW50LFxuICBzb3VyY2U6IGVsZW1lbnQsXG4gIHNwYW46IGVsZW1lbnQsXG4gIHN0cm9uZzogZWxlbWVudCxcbiAgc3R5bGU6IGVsZW1lbnQsXG4gIHN1YjogZWxlbWVudCxcbiAgc3VtbWFyeTogZWxlbWVudCxcbiAgc3VwOiBlbGVtZW50LFxuICB0YWJsZTogZWxlbWVudCxcbiAgdGJvZHk6IGVsZW1lbnQsXG4gIHRkOiBlbGVtZW50LFxuICB0ZXh0YXJlYTogZWxlbWVudCxcbiAgdGZvb3Q6IGVsZW1lbnQsXG4gIHRoOiBlbGVtZW50LFxuICB0aGVhZDogZWxlbWVudCxcbiAgdGltZTogZWxlbWVudCxcbiAgdGl0bGU6IGVsZW1lbnQsXG4gIHRyOiBlbGVtZW50LFxuICB0cmFjazogZWxlbWVudCxcbiAgdTogZWxlbWVudCxcbiAgdWw6IGVsZW1lbnQsXG4gIHZhcjogZWxlbWVudCxcbiAgdmlkZW86IGVsZW1lbnQsXG4gIHdicjogZWxlbWVudCxcbiAgY2lyY2xlOiBlbGVtZW50LFxuICBjbGlwUGF0aDogZWxlbWVudCxcbiAgZGVmczogZWxlbWVudCxcbiAgZWxsaXBzZTogZWxlbWVudCxcbiAgZzogZWxlbWVudCxcbiAgbGluZTogZWxlbWVudCxcbiAgbGluZWFyR3JhZGllbnQ6IGVsZW1lbnQsXG4gIG1hc2s6IGVsZW1lbnQsXG4gIHBhdGg6IGVsZW1lbnQsXG4gIHBhdHRlcm46IGVsZW1lbnQsXG4gIHBvbHlnb246IGVsZW1lbnQsXG4gIHBvbHlsaW5lOiBlbGVtZW50LFxuICByYWRpYWxHcmFkaWVudDogZWxlbWVudCxcbiAgcmVjdDogZWxlbWVudCxcbiAgc3RvcDogZWxlbWVudCxcbiAgc3ZnOiBlbGVtZW50LFxuICB0ZXh0OiBlbGVtZW50LFxuICB0c3BhbjogZWxlbWVudFxufVxuXG5leHBvcnQgY29uc3QgaHRtbDogSHRtbCA9IFtcbiAgXCJhXCIsXG4gIFwiYWJiclwiLFxuICBcImFkZHJlc3NcIixcbiAgXCJhcmVhXCIsXG4gIFwiYXJ0aWNsZVwiLFxuICBcImFzaWRlXCIsXG4gIFwiYXVkaW9cIixcbiAgXCJiXCIsXG4gIFwiYmFzZVwiLFxuICBcImJkaVwiLFxuICBcImJkb1wiLFxuICBcImJpZ1wiLFxuICBcImJsb2NrcXVvdGVcIixcbiAgXCJib2R5XCIsXG4gIFwiYnJcIixcbiAgXCJidXR0b25cIixcbiAgXCJjYW52YXNcIixcbiAgXCJjYXB0aW9uXCIsXG4gIFwiY2l0ZVwiLFxuICBcImNvZGVcIixcbiAgXCJjb2xcIixcbiAgXCJjb2xncm91cFwiLFxuICBcImRhdGFcIixcbiAgXCJkYXRhbGlzdFwiLFxuICBcImRkXCIsXG4gIFwiZGVsXCIsXG4gIFwiZGV0YWlsc1wiLFxuICBcImRmblwiLFxuICBcImRpYWxvZ1wiLFxuICBcImRpdlwiLFxuICBcImRsXCIsXG4gIFwiZHRcIixcbiAgXCJlbVwiLFxuICBcImVtYmVkXCIsXG4gIFwiZmllbGRzZXRcIixcbiAgXCJmaWdjYXB0aW9uXCIsXG4gIFwiZmlndXJlXCIsXG4gIFwiZm9vdGVyXCIsXG4gIFwiZm9ybVwiLFxuICBcImgxXCIsXG4gIFwiaDJcIixcbiAgXCJoM1wiLFxuICBcImg0XCIsXG4gIFwiaDVcIixcbiAgXCJoNlwiLFxuICBcImhlYWRcIixcbiAgXCJoZWFkZXJcIixcbiAgXCJoclwiLFxuICBcImh0bWxcIixcbiAgXCJpXCIsXG4gIFwiaWZyYW1lXCIsXG4gIFwiaW1nXCIsXG4gIFwiaW5wdXRcIixcbiAgXCJpbnNcIixcbiAgXCJrYmRcIixcbiAgXCJrZXlnZW5cIixcbiAgXCJsYWJlbFwiLFxuICBcImxlZ2VuZFwiLFxuICBcImxpXCIsXG4gIFwibGlua1wiLFxuICBcIm1haW5cIixcbiAgXCJtYXBcIixcbiAgXCJtYXJrXCIsXG4gIFwibWVudVwiLFxuICBcIm1lbnVpdGVtXCIsXG4gIFwibWV0YVwiLFxuICBcIm1ldGVyXCIsXG4gIFwibmF2XCIsXG4gIFwibm9zY3JpcHRcIixcbiAgXCJvYmplY3RcIixcbiAgXCJvbFwiLFxuICBcIm9wdGdyb3VwXCIsXG4gIFwib3B0aW9uXCIsXG4gIFwib3V0cHV0XCIsXG4gIFwicFwiLFxuICBcInBhcmFtXCIsXG4gIFwicGljdHVyZVwiLFxuICBcInByZVwiLFxuICBcInByb2dyZXNzXCIsXG4gIFwicVwiLFxuICBcInJwXCIsXG4gIFwicnRcIixcbiAgXCJydWJ5XCIsXG4gIFwic1wiLFxuICBcInNhbXBcIixcbiAgXCJzY3JpcHRcIixcbiAgXCJzZWN0aW9uXCIsXG4gIFwic2VsZWN0XCIsXG4gIFwic21hbGxcIixcbiAgXCJzb3VyY2VcIixcbiAgXCJzcGFuXCIsXG4gIFwic3Ryb25nXCIsXG4gIFwic3R5bGVcIixcbiAgXCJzdWJcIixcbiAgXCJzdW1tYXJ5XCIsXG4gIFwic3VwXCIsXG4gIFwidGFibGVcIixcbiAgXCJ0Ym9keVwiLFxuICBcInRkXCIsXG4gIFwidGV4dGFyZWFcIixcbiAgXCJ0Zm9vdFwiLFxuICBcInRoXCIsXG4gIFwidGhlYWRcIixcbiAgXCJ0aW1lXCIsXG4gIFwidGl0bGVcIixcbiAgXCJ0clwiLFxuICBcInRyYWNrXCIsXG4gIFwidVwiLFxuICBcInVsXCIsXG4gIFwidmFyXCIsXG4gIFwidmlkZW9cIixcbiAgXCJ3YnJcIixcbiAgXCJjaXJjbGVcIixcbiAgXCJjbGlwUGF0aFwiLFxuICBcImRlZnNcIixcbiAgXCJlbGxpcHNlXCIsXG4gIFwiZ1wiLFxuICBcImxpbmVcIixcbiAgXCJsaW5lYXJHcmFkaWVudFwiLFxuICBcIm1hc2tcIixcbiAgXCJwYXRoXCIsXG4gIFwicGF0dGVyblwiLFxuICBcInBvbHlnb25cIixcbiAgXCJwb2x5bGluZVwiLFxuICBcInJhZGlhbEdyYWRpZW50XCIsXG4gIFwicmVjdFwiLFxuICBcInN0b3BcIixcbiAgXCJzdmdcIixcbiAgXCJ0ZXh0XCIsXG4gIFwidHNwYW5cIlxuXS5yZWR1Y2UoXG4gIChodG1sLCB0YWdOYW1lKSA9PiB7XG4gICAgY29uc3QgZWxlbWVudDogZWxlbWVudCA9IChwcm9wZXJ0aWVzLCBjaGlsZHJlbikgPT5cbiAgICAgIG5vZGUodGFnTmFtZSwgcHJvcGVydGllcywgY2hpbGRyZW4pXG5cbiAgICBodG1sW3RhZ05hbWVdID0gZWxlbWVudFxuICAgIHJldHVybiBodG1sXG4gIH0sXG4gIC8vIEBIYWNrOiBXb3JrYXJvdW5kaW5nIGZhY2Vib29rL2Zsb3cjMTY4M1xuICAoT2JqZWN0LmNyZWF0ZShudWxsKSwge30pXG4pXG4iXX0=
(function (global, factory) {
  if (typeof define === "function" && define.amd) {
    define(["exports", "./driver", "./signal", "./subscription", "./dom", "./html", "./application", "./task", "./effects"], factory);
  } else if (typeof exports !== "undefined") {
    factory(exports, require("./driver"), require("./signal"), require("./subscription"), require("./dom"), require("./html"), require("./application"), require("./task"), require("./effects"));
  } else {
    var mod = {
      exports: {}
    };
    factory(mod.exports, global.driver, global.signal, global.subscription, global.dom, global.html, global.application, global.task, global.effects);
    global.index = mod.exports;
  }
})(this, function (exports, _driver, _signal, _subscription, _dom, _html, _application, _task, _effects) {
  "use strict";

  Object.defineProperty(exports, "__esModule", {
    value: true
  });
  exports.Subscription = exports.Driver = exports.Effects = exports.Task = exports.beginner = exports.start = exports.html = exports.root = exports.thunk = exports.text = exports.node = exports.subscription = exports.forward = exports.VirtualRoot = exports.Address = exports.VirtualTree = exports.LazyTree = exports.Widget = exports.Thunk = exports.VirtualNode = exports.VirtualText = exports.StyleDictionary = exports.AttributeDictionary = exports.PropertyDictionary = undefined;
  Object.defineProperty(exports, "PropertyDictionary", {
    enumerable: true,
    get: function () {
      return _driver.PropertyDictionary;
    }
  });
  Object.defineProperty(exports, "AttributeDictionary", {
    enumerable: true,
    get: function () {
      return _driver.AttributeDictionary;
    }
  });
  Object.defineProperty(exports, "StyleDictionary", {
    enumerable: true,
    get: function () {
      return _driver.StyleDictionary;
    }
  });
  Object.defineProperty(exports, "VirtualText", {
    enumerable: true,
    get: function () {
      return _driver.VirtualText;
    }
  });
  Object.defineProperty(exports, "VirtualNode", {
    enumerable: true,
    get: function () {
      return _driver.VirtualNode;
    }
  });
  Object.defineProperty(exports, "Thunk", {
    enumerable: true,
    get: function () {
      return _driver.Thunk;
    }
  });
  Object.defineProperty(exports, "Widget", {
    enumerable: true,
    get: function () {
      return _driver.Widget;
    }
  });
  Object.defineProperty(exports, "LazyTree", {
    enumerable: true,
    get: function () {
      return _driver.LazyTree;
    }
  });
  Object.defineProperty(exports, "VirtualTree", {
    enumerable: true,
    get: function () {
      return _driver.VirtualTree;
    }
  });
  Object.defineProperty(exports, "Address", {
    enumerable: true,
    get: function () {
      return _driver.Address;
    }
  });
  Object.defineProperty(exports, "VirtualRoot", {
    enumerable: true,
    get: function () {
      return _driver.VirtualRoot;
    }
  });
  Object.defineProperty(exports, "forward", {
    enumerable: true,
    get: function () {
      return _signal.forward;
    }
  });
  Object.defineProperty(exports, "subscription", {
    enumerable: true,
    get: function () {
      return _subscription.subscription;
    }
  });
  Object.defineProperty(exports, "node", {
    enumerable: true,
    get: function () {
      return _dom.node;
    }
  });
  Object.defineProperty(exports, "text", {
    enumerable: true,
    get: function () {
      return _dom.text;
    }
  });
  Object.defineProperty(exports, "thunk", {
    enumerable: true,
    get: function () {
      return _dom.thunk;
    }
  });
  Object.defineProperty(exports, "root", {
    enumerable: true,
    get: function () {
      return _dom.root;
    }
  });
  Object.defineProperty(exports, "html", {
    enumerable: true,
    get: function () {
      return _html.html;
    }
  });
  Object.defineProperty(exports, "start", {
    enumerable: true,
    get: function () {
      return _application.start;
    }
  });
  Object.defineProperty(exports, "beginner", {
    enumerable: true,
    get: function () {
      return _application.beginner;
    }
  });
  Object.defineProperty(exports, "Task", {
    enumerable: true,
    get: function () {
      return _task.Task;
    }
  });
  Object.defineProperty(exports, "Effects", {
    enumerable: true,
    get: function () {
      return _effects.Effects;
    }
  });

  var Driver = _interopRequireWildcard(_driver);

  var Subscription = _interopRequireWildcard(_subscription);

  function _interopRequireWildcard(obj) {
    if (obj && obj.__esModule) {
      return obj;
    } else {
      var newObj = {};

      if (obj != null) {
        for (var key in obj) {
          if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key];
        }
      }

      newObj.default = obj;
      return newObj;
    }
  }

  exports.Driver = Driver;
  exports.Subscription = Subscription;
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9pbmRleC5qcyJdLCJuYW1lcyI6WyJQcm9wZXJ0eURpY3Rpb25hcnkiLCJBdHRyaWJ1dGVEaWN0aW9uYXJ5IiwiU3R5bGVEaWN0aW9uYXJ5IiwiVmlydHVhbFRleHQiLCJWaXJ0dWFsTm9kZSIsIlRodW5rIiwiV2lkZ2V0IiwiTGF6eVRyZWUiLCJWaXJ0dWFsVHJlZSIsIkFkZHJlc3MiLCJWaXJ0dWFsUm9vdCIsImZvcndhcmQiLCJzdWJzY3JpcHRpb24iLCJub2RlIiwidGV4dCIsInRodW5rIiwicm9vdCIsImh0bWwiLCJzdGFydCIsImJlZ2lubmVyIiwiVGFzayIsIkVmZmVjdHMiLCJEcml2ZXIiLCJTdWJzY3JpcHRpb24iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7cUJBTUVBLGtCOzs7Ozs7cUJBQ0FDLG1COzs7Ozs7cUJBQ0FDLGU7Ozs7OztxQkFDQUMsVzs7Ozs7O3FCQUNBQyxXOzs7Ozs7cUJBQ0FDLEs7Ozs7OztxQkFDQUMsTTs7Ozs7O3FCQUNBQyxROzs7Ozs7cUJBQ0FDLFc7Ozs7OztxQkFDQUMsTzs7Ozs7O3FCQUNBQyxXOzs7Ozs7cUJBWU9DLE87Ozs7OzsyQkFDQUMsWTs7Ozs7O2tCQUNBQyxJOzs7Ozs7a0JBQU1DLEk7Ozs7OztrQkFBTUMsSzs7Ozs7O2tCQUFPQyxJOzs7Ozs7bUJBQ25CQyxJOzs7Ozs7MEJBQ0FDLEs7Ozs7OzswQkFBT0MsUTs7Ozs7O21CQUNQQyxJOzs7Ozs7c0JBQ0FDLE87Ozs7TUFoQ0dDLE07O01BQ0FDLFk7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7VUFpQ0hELE0sR0FBQUEsTTtVQUFRQyxZLEdBQUFBLFkiLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKiBAZmxvdyAqL1xuXG5pbXBvcnQgKiBhcyBEcml2ZXIgZnJvbSBcIi4vZHJpdmVyXCJcbmltcG9ydCAqIGFzIFN1YnNjcmlwdGlvbiBmcm9tIFwiLi9zdWJzY3JpcHRpb25cIlxuXG5leHBvcnQge1xuICBQcm9wZXJ0eURpY3Rpb25hcnksXG4gIEF0dHJpYnV0ZURpY3Rpb25hcnksXG4gIFN0eWxlRGljdGlvbmFyeSxcbiAgVmlydHVhbFRleHQsXG4gIFZpcnR1YWxOb2RlLFxuICBUaHVuayxcbiAgV2lkZ2V0LFxuICBMYXp5VHJlZSxcbiAgVmlydHVhbFRyZWUsXG4gIEFkZHJlc3MsXG4gIFZpcnR1YWxSb290XG59IGZyb20gXCIuL2RyaXZlclwiXG5cbmV4cG9ydCB0eXBlIHtcbiAgQXBwbGljYXRpb24sXG4gIEFkdmFuY2VkQ29uZmlndXJhdGlvbixcbiAgQmVnaW5uZXJDb25maWd1cmF0aW9uXG59IGZyb20gXCIuL2FwcGxpY2F0aW9uXCJcbmV4cG9ydCB0eXBlIHsgSW5pdCwgVXBkYXRlLCBWaWV3IH0gZnJvbSBcIi4vYXBwbGljYXRpb25cIlxuZXhwb3J0IHR5cGUgeyBET00gfSBmcm9tIFwiLi9kb21cIlxuZXhwb3J0IHR5cGUgeyBOZXZlciB9IGZyb20gXCIuL2VmZmVjdHNcIlxuXG5leHBvcnQgeyBmb3J3YXJkIH0gZnJvbSBcIi4vc2lnbmFsXCJcbmV4cG9ydCB7IHN1YnNjcmlwdGlvbiB9IGZyb20gXCIuL3N1YnNjcmlwdGlvblwiXG5leHBvcnQgeyBub2RlLCB0ZXh0LCB0aHVuaywgcm9vdCB9IGZyb20gXCIuL2RvbVwiXG5leHBvcnQgeyBodG1sIH0gZnJvbSBcIi4vaHRtbFwiXG5leHBvcnQgeyBzdGFydCwgYmVnaW5uZXIgfSBmcm9tIFwiLi9hcHBsaWNhdGlvblwiXG5leHBvcnQgeyBUYXNrIH0gZnJvbSBcIi4vdGFza1wiXG5leHBvcnQgeyBFZmZlY3RzIH0gZnJvbSBcIi4vZWZmZWN0c1wiXG5cbmV4cG9ydCB7IERyaXZlciwgU3Vic2NyaXB0aW9uIH1cbiJdfQ==
(function (global, factory) {
  if (typeof define === "function" && define.amd) {
    define(["exports"], factory);
  } else if (typeof exports !== "undefined") {
    factory(exports);
  } else {
    var mod = {
      exports: {}
    };
    factory(mod.exports);
    global.preemptiveAnimationFrame = mod.exports;
  }
})(this, function (exports) {
  "use strict";

  Object.defineProperty(exports, "__esModule", {
    value: true
  });


  // Invariants:
  // 1. In the NO_REQUEST state, there is never a scheduled animation frame.
  // 2. In the PENDING_REQUEST and EXTRA_REQUEST states, there is always exactly
  // one scheduled animation frame.
  const NO_REQUEST = 0;
  const PENDING_REQUEST = 1;
  const EXTRA_REQUEST = 2;

  let nextID = 0;
  let state = NO_REQUEST;
  let requests = [];
  let ids = [];

  const absent = new String("absent");

  const requestAnimationFrame = exports.requestAnimationFrame = request => {
    if (state === NO_REQUEST) {
      window.requestAnimationFrame(performAnimationFrame);
    }

    const id = ++nextID;
    requests.push(request);
    ids.push(id);
    state = PENDING_REQUEST;
    return id;
  };

  const cancelAnimationFrame = exports.cancelAnimationFrame = id => {
    const index = ids.indexOf(id);
    if (index >= 0) {
      ids.splice(index, 1);
      requests.splice(index, 1);
    }
  };

  const forceAnimationFrame = exports.forceAnimationFrame = (time = window.performance.now()) => performAnimationFrame(time);

  const performAnimationFrame = time => {
    switch (state) {
      case NO_REQUEST:
        // This state should not be possible. How can there be no
        // request, yet somehow we are actively fulfilling a
        // request?
        throw Error(`Unexpected frame request`);
      case PENDING_REQUEST:
        // At this point, we do not *know* that another frame is
        // needed, but we make an extra frame request just in
        // case. It's possible to drop a frame if frame is requested
        // too late, so we just do it preemptively.
        window.requestAnimationFrame(performAnimationFrame);
        state = EXTRA_REQUEST;
        ids.splice(0);
        dispatchAnimationFrame(requests.splice(0), 0, time);
        break;
      case EXTRA_REQUEST:
        // Turns out the extra request was not needed, so we will
        // stop requesting. No reason to call it all the time if
        // no one needs it.
        state = NO_REQUEST;
        break;
    }
  };

  const dispatchAnimationFrame = (requests, index, time) => {
    let exception = absent;
    const count = requests.length;
    try {
      while (index < count) {
        const request = requests[index];
        index = index + 1;
        request(time);
      }
    } catch (error) {
      exception = error;
    }

    if (index < count) {
      dispatchAnimationFrame(requests, index, time);
    }

    if (exception != absent) {
      throw exception;
    }
  };
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9wcmVlbXB0aXZlLWFuaW1hdGlvbi1mcmFtZS5qcyJdLCJuYW1lcyI6WyJOT19SRVFVRVNUIiwiUEVORElOR19SRVFVRVNUIiwiRVhUUkFfUkVRVUVTVCIsIm5leHRJRCIsInN0YXRlIiwicmVxdWVzdHMiLCJpZHMiLCJhYnNlbnQiLCJTdHJpbmciLCJyZXF1ZXN0QW5pbWF0aW9uRnJhbWUiLCJyZXF1ZXN0Iiwid2luZG93IiwicGVyZm9ybUFuaW1hdGlvbkZyYW1lIiwiaWQiLCJwdXNoIiwiY2FuY2VsQW5pbWF0aW9uRnJhbWUiLCJpbmRleCIsImluZGV4T2YiLCJzcGxpY2UiLCJmb3JjZUFuaW1hdGlvbkZyYW1lIiwidGltZSIsInBlcmZvcm1hbmNlIiwibm93IiwiRXJyb3IiLCJkaXNwYXRjaEFuaW1hdGlvbkZyYW1lIiwiZXhjZXB0aW9uIiwiY291bnQiLCJsZW5ndGgiLCJlcnJvciJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQU1BLGFBQWEsQ0FBbkI7QUFDQSxRQUFNQyxrQkFBa0IsQ0FBeEI7QUFDQSxRQUFNQyxnQkFBZ0IsQ0FBdEI7O0FBRUEsTUFBSUMsU0FBaUIsQ0FBckI7QUFDQSxNQUFJQyxRQUFlSixVQUFuQjtBQUNBLE1BQUlLLFdBQXVDLEVBQTNDO0FBQ0EsTUFBSUMsTUFBcUIsRUFBekI7O0FBRUEsUUFBTUMsU0FBUyxJQUFJQyxNQUFKLENBQVcsUUFBWCxDQUFmOztBQUVPLFFBQU1DLHdEQUE0QkMsT0FBSixJQUFtQztBQUN0RSxRQUFJTixVQUFVSixVQUFkLEVBQTBCO0FBQ3hCVyxhQUFPRixxQkFBUCxDQUE2QkcscUJBQTdCO0FBQ0Q7O0FBRUQsVUFBTUMsS0FBSyxFQUFFVixNQUFiO0FBQ0FFLGFBQVNTLElBQVQsQ0FBY0osT0FBZDtBQUNBSixRQUFJUSxJQUFKLENBQVNELEVBQVQ7QUFDQVQsWUFBUUgsZUFBUjtBQUNBLFdBQU9ZLEVBQVA7QUFDRCxHQVZNOztBQVlBLFFBQU1FLHNEQUF3QkYsRUFBRCxJQUFzQjtBQUN4RCxVQUFNRyxRQUFRVixJQUFJVyxPQUFKLENBQVlKLEVBQVosQ0FBZDtBQUNBLFFBQUlHLFNBQVMsQ0FBYixFQUFnQjtBQUNkVixVQUFJWSxNQUFKLENBQVdGLEtBQVgsRUFBa0IsQ0FBbEI7QUFDQVgsZUFBU2EsTUFBVCxDQUFnQkYsS0FBaEIsRUFBdUIsQ0FBdkI7QUFDRDtBQUNGLEdBTk07O0FBUUEsUUFBTUcsb0RBQXNCLENBQUNDLE9BQWFULE9BQU9VLFdBQVAsQ0FBbUJDLEdBQW5CLEVBQWQsS0FDakNWLHNCQUFzQlEsSUFBdEIsQ0FESzs7QUFHUCxRQUFNUix3QkFBeUJRLElBQUQsSUFBZ0I7QUFDNUMsWUFBUWhCLEtBQVI7QUFDRSxXQUFLSixVQUFMO0FBQ0U7QUFDQTtBQUNBO0FBQ0EsY0FBTXVCLE1BQU8sMEJBQVAsQ0FBTjtBQUNGLFdBQUt0QixlQUFMO0FBQ0U7QUFDQTtBQUNBO0FBQ0E7QUFDQVUsZUFBT0YscUJBQVAsQ0FBNkJHLHFCQUE3QjtBQUNBUixnQkFBUUYsYUFBUjtBQUNBSSxZQUFJWSxNQUFKLENBQVcsQ0FBWDtBQUNBTSwrQkFBdUJuQixTQUFTYSxNQUFULENBQWdCLENBQWhCLENBQXZCLEVBQTJDLENBQTNDLEVBQThDRSxJQUE5QztBQUNBO0FBQ0YsV0FBS2xCLGFBQUw7QUFDRTtBQUNBO0FBQ0E7QUFDQUUsZ0JBQVFKLFVBQVI7QUFDQTtBQXJCSjtBQXVCRCxHQXhCRDs7QUEwQkEsUUFBTXdCLHlCQUF5QixDQUM3Qm5CLFFBRDZCLEVBRTdCVyxLQUY2QixFQUc3QkksSUFINkIsS0FJMUI7QUFDSCxRQUFJSyxZQUE0QmxCLE1BQWhDO0FBQ0EsVUFBTW1CLFFBQVFyQixTQUFTc0IsTUFBdkI7QUFDQSxRQUFJO0FBQ0YsYUFBT1gsUUFBUVUsS0FBZixFQUFzQjtBQUNwQixjQUFNaEIsVUFBVUwsU0FBU1csS0FBVCxDQUFoQjtBQUNBQSxnQkFBUUEsUUFBUSxDQUFoQjtBQUNBTixnQkFBUVUsSUFBUjtBQUNEO0FBQ0YsS0FORCxDQU1FLE9BQU9RLEtBQVAsRUFBYztBQUNkSCxrQkFBWUcsS0FBWjtBQUNEOztBQUVELFFBQUlaLFFBQVFVLEtBQVosRUFBbUI7QUFDakJGLDZCQUF1Qm5CLFFBQXZCLEVBQWlDVyxLQUFqQyxFQUF3Q0ksSUFBeEM7QUFDRDs7QUFFRCxRQUFJSyxhQUFhbEIsTUFBakIsRUFBeUI7QUFDdkIsWUFBTWtCLFNBQU47QUFDRDtBQUNGLEdBeEJEIiwiZmlsZSI6InByZWVtcHRpdmUtYW5pbWF0aW9uLWZyYW1lLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyogQGZsb3cgKi9cblxudHlwZSBUaW1lID0gbnVtYmVyXG50eXBlIFN0YXRlID0gMCB8IDEgfCAyXG5cbi8vIEludmFyaWFudHM6XG4vLyAxLiBJbiB0aGUgTk9fUkVRVUVTVCBzdGF0ZSwgdGhlcmUgaXMgbmV2ZXIgYSBzY2hlZHVsZWQgYW5pbWF0aW9uIGZyYW1lLlxuLy8gMi4gSW4gdGhlIFBFTkRJTkdfUkVRVUVTVCBhbmQgRVhUUkFfUkVRVUVTVCBzdGF0ZXMsIHRoZXJlIGlzIGFsd2F5cyBleGFjdGx5XG4vLyBvbmUgc2NoZWR1bGVkIGFuaW1hdGlvbiBmcmFtZS5cbmNvbnN0IE5PX1JFUVVFU1QgPSAwXG5jb25zdCBQRU5ESU5HX1JFUVVFU1QgPSAxXG5jb25zdCBFWFRSQV9SRVFVRVNUID0gMlxuXG5sZXQgbmV4dElEOiBudW1iZXIgPSAwXG5sZXQgc3RhdGU6IFN0YXRlID0gTk9fUkVRVUVTVFxubGV0IHJlcXVlc3RzOiBBcnJheTwodGltZTogVGltZSkgPT4gYW55PiA9IFtdXG5sZXQgaWRzOiBBcnJheTxudW1iZXI+ID0gW11cblxuY29uc3QgYWJzZW50ID0gbmV3IFN0cmluZyhcImFic2VudFwiKVxuXG5leHBvcnQgY29uc3QgcmVxdWVzdEFuaW1hdGlvbkZyYW1lID0gPGE+KHJlcXVlc3Q6ICh0aW1lOiBUaW1lKSA9PiBhKSA9PiB7XG4gIGlmIChzdGF0ZSA9PT0gTk9fUkVRVUVTVCkge1xuICAgIHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUocGVyZm9ybUFuaW1hdGlvbkZyYW1lKVxuICB9XG5cbiAgY29uc3QgaWQgPSArK25leHRJRFxuICByZXF1ZXN0cy5wdXNoKHJlcXVlc3QpXG4gIGlkcy5wdXNoKGlkKVxuICBzdGF0ZSA9IFBFTkRJTkdfUkVRVUVTVFxuICByZXR1cm4gaWRcbn1cblxuZXhwb3J0IGNvbnN0IGNhbmNlbEFuaW1hdGlvbkZyYW1lID0gKGlkOiBudW1iZXIpOiB2b2lkID0+IHtcbiAgY29uc3QgaW5kZXggPSBpZHMuaW5kZXhPZihpZClcbiAgaWYgKGluZGV4ID49IDApIHtcbiAgICBpZHMuc3BsaWNlKGluZGV4LCAxKVxuICAgIHJlcXVlc3RzLnNwbGljZShpbmRleCwgMSlcbiAgfVxufVxuXG5leHBvcnQgY29uc3QgZm9yY2VBbmltYXRpb25GcmFtZSA9ICh0aW1lOiBUaW1lID0gd2luZG93LnBlcmZvcm1hbmNlLm5vdygpKSA9PlxuICBwZXJmb3JtQW5pbWF0aW9uRnJhbWUodGltZSlcblxuY29uc3QgcGVyZm9ybUFuaW1hdGlvbkZyYW1lID0gKHRpbWU6IFRpbWUpID0+IHtcbiAgc3dpdGNoIChzdGF0ZSkge1xuICAgIGNhc2UgTk9fUkVRVUVTVDpcbiAgICAgIC8vIFRoaXMgc3RhdGUgc2hvdWxkIG5vdCBiZSBwb3NzaWJsZS4gSG93IGNhbiB0aGVyZSBiZSBub1xuICAgICAgLy8gcmVxdWVzdCwgeWV0IHNvbWVob3cgd2UgYXJlIGFjdGl2ZWx5IGZ1bGZpbGxpbmcgYVxuICAgICAgLy8gcmVxdWVzdD9cbiAgICAgIHRocm93IEVycm9yKGBVbmV4cGVjdGVkIGZyYW1lIHJlcXVlc3RgKVxuICAgIGNhc2UgUEVORElOR19SRVFVRVNUOlxuICAgICAgLy8gQXQgdGhpcyBwb2ludCwgd2UgZG8gbm90ICprbm93KiB0aGF0IGFub3RoZXIgZnJhbWUgaXNcbiAgICAgIC8vIG5lZWRlZCwgYnV0IHdlIG1ha2UgYW4gZXh0cmEgZnJhbWUgcmVxdWVzdCBqdXN0IGluXG4gICAgICAvLyBjYXNlLiBJdCdzIHBvc3NpYmxlIHRvIGRyb3AgYSBmcmFtZSBpZiBmcmFtZSBpcyByZXF1ZXN0ZWRcbiAgICAgIC8vIHRvbyBsYXRlLCBzbyB3ZSBqdXN0IGRvIGl0IHByZWVtcHRpdmVseS5cbiAgICAgIHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUocGVyZm9ybUFuaW1hdGlvbkZyYW1lKVxuICAgICAgc3RhdGUgPSBFWFRSQV9SRVFVRVNUXG4gICAgICBpZHMuc3BsaWNlKDApXG4gICAgICBkaXNwYXRjaEFuaW1hdGlvbkZyYW1lKHJlcXVlc3RzLnNwbGljZSgwKSwgMCwgdGltZSlcbiAgICAgIGJyZWFrXG4gICAgY2FzZSBFWFRSQV9SRVFVRVNUOlxuICAgICAgLy8gVHVybnMgb3V0IHRoZSBleHRyYSByZXF1ZXN0IHdhcyBub3QgbmVlZGVkLCBzbyB3ZSB3aWxsXG4gICAgICAvLyBzdG9wIHJlcXVlc3RpbmcuIE5vIHJlYXNvbiB0byBjYWxsIGl0IGFsbCB0aGUgdGltZSBpZlxuICAgICAgLy8gbm8gb25lIG5lZWRzIGl0LlxuICAgICAgc3RhdGUgPSBOT19SRVFVRVNUXG4gICAgICBicmVha1xuICB9XG59XG5cbmNvbnN0IGRpc3BhdGNoQW5pbWF0aW9uRnJhbWUgPSA8YT4oXG4gIHJlcXVlc3RzOiBBcnJheTwodGltZTogVGltZSkgPT4gYT4sXG4gIGluZGV4OiBudW1iZXIsXG4gIHRpbWU6IFRpbWVcbikgPT4ge1xuICBsZXQgZXhjZXB0aW9uOiBTdHJpbmcgfCBFcnJvciA9IGFic2VudFxuICBjb25zdCBjb3VudCA9IHJlcXVlc3RzLmxlbmd0aFxuICB0cnkge1xuICAgIHdoaWxlIChpbmRleCA8IGNvdW50KSB7XG4gICAgICBjb25zdCByZXF1ZXN0ID0gcmVxdWVzdHNbaW5kZXhdXG4gICAgICBpbmRleCA9IGluZGV4ICsgMVxuICAgICAgcmVxdWVzdCh0aW1lKVxuICAgIH1cbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBleGNlcHRpb24gPSBlcnJvclxuICB9XG5cbiAgaWYgKGluZGV4IDwgY291bnQpIHtcbiAgICBkaXNwYXRjaEFuaW1hdGlvbkZyYW1lKHJlcXVlc3RzLCBpbmRleCwgdGltZSlcbiAgfVxuXG4gIGlmIChleGNlcHRpb24gIT0gYWJzZW50KSB7XG4gICAgdGhyb3cgZXhjZXB0aW9uXG4gIH1cbn1cbiJdfQ==
(function (global, factory) {
  if (typeof define === "function" && define.amd) {
    define(["exports"], factory);
  } else if (typeof exports !== "undefined") {
    factory(exports);
  } else {
    var mod = {
      exports: {}
    };
    factory(mod.exports);
    global.signal = mod.exports;
  }
})(this, function (exports) {
  "use strict";

  Object.defineProperty(exports, "__esModule", {
    value: true
  });


  const Forward = (address, tag) => {
    const forward = message => address(tag(message));
    forward.to = address;
    forward.tag = tag;
    return forward;
  };


  if (global["reflex/address"] == null) {
    global["reflex/address"] = 0;
  }

  // Create a new address. This address will tag each message it receives and then
  // forward it along to the given address.
  // Example:
  //
  // const Remove = target => {type: "Remove", target}
  // removeAddress = forward(address, Remove)
  //
  // Above example created `removeAddress` tags each message with `Remove` tag
  // before forwarding them to a general `address`.
  const forward = exports.forward = (address, tag) => {
    // Genrate ID for each address that has a forwarding addresses so that
    // forwarding addresses could be cached by that id and a tag-ing function.
    const id = address.id != null ? address.id : address.id = global["reflex/address"]++;
    const key = `reflex/address/${id}`;

    return tag[key] || (tag[key] = Forward(address, tag));
  };
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9zaWduYWwuanMiXSwibmFtZXMiOlsiRm9yd2FyZCIsImFkZHJlc3MiLCJ0YWciLCJmb3J3YXJkIiwibWVzc2FnZSIsInRvIiwiZ2xvYmFsIiwiaWQiLCJrZXkiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBR0EsUUFBTUEsVUFBVSxDQUFPQyxPQUFQLEVBQTRCQyxHQUE1QixLQUE2RDtBQUMzRSxVQUFNQyxVQUFXQyxPQUFELElBQWdCSCxRQUFRQyxJQUFJRSxPQUFKLENBQVIsQ0FBaEM7QUFDQUQsWUFBUUUsRUFBUixHQUFhSixPQUFiO0FBQ0FFLFlBQVFELEdBQVIsR0FBY0EsR0FBZDtBQUNBLFdBQU9DLE9BQVA7QUFDRCxHQUxEOzs7QUFPQSxNQUFJRyxPQUFPLGdCQUFQLEtBQTRCLElBQWhDLEVBQXNDO0FBQ3BDQSxXQUFPLGdCQUFQLElBQTJCLENBQTNCO0FBQ0Q7O0FBRUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ08sUUFBTUgsNEJBQVUsQ0FDckJGLE9BRHFCLEVBRXJCQyxHQUZxQixLQUdOO0FBQ2Y7QUFDQTtBQUNBLFVBQU1LLEtBQUtOLFFBQVFNLEVBQVIsSUFBYyxJQUFkLEdBQ1BOLFFBQVFNLEVBREQsR0FFTk4sUUFBUU0sRUFBUixHQUFhRCxPQUFPLGdCQUFQLEdBRmxCO0FBR0EsVUFBTUUsTUFBTyxrQkFBaUJELEVBQUcsRUFBakM7O0FBRUEsV0FBT0wsSUFBSU0sR0FBSixNQUFhTixJQUFJTSxHQUFKLElBQVdSLFFBQVFDLE9BQVIsRUFBaUJDLEdBQWpCLENBQXhCLENBQVA7QUFDRCxHQVpNIiwiZmlsZSI6InNpZ25hbC5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qIEBmbG93ICovXG5pbXBvcnQgdHlwZSB7IEFkZHJlc3MgfSBmcm9tIFwiLi9kcml2ZXJcIlxuXG5jb25zdCBGb3J3YXJkID0gPGEsIGI+KGFkZHJlc3M6IEFkZHJlc3M8Yj4sIHRhZzogKGE6IGEpID0+IGIpOiBBZGRyZXNzPGE+ID0+IHtcbiAgY29uc3QgZm9yd2FyZCA9IChtZXNzYWdlOiBhKSA9PiBhZGRyZXNzKHRhZyhtZXNzYWdlKSlcbiAgZm9yd2FyZC50byA9IGFkZHJlc3NcbiAgZm9yd2FyZC50YWcgPSB0YWdcbiAgcmV0dXJuIGZvcndhcmRcbn1cblxuaWYgKGdsb2JhbFtcInJlZmxleC9hZGRyZXNzXCJdID09IG51bGwpIHtcbiAgZ2xvYmFsW1wicmVmbGV4L2FkZHJlc3NcIl0gPSAwXG59XG5cbi8vIENyZWF0ZSBhIG5ldyBhZGRyZXNzLiBUaGlzIGFkZHJlc3Mgd2lsbCB0YWcgZWFjaCBtZXNzYWdlIGl0IHJlY2VpdmVzIGFuZCB0aGVuXG4vLyBmb3J3YXJkIGl0IGFsb25nIHRvIHRoZSBnaXZlbiBhZGRyZXNzLlxuLy8gRXhhbXBsZTpcbi8vXG4vLyBjb25zdCBSZW1vdmUgPSB0YXJnZXQgPT4ge3R5cGU6IFwiUmVtb3ZlXCIsIHRhcmdldH1cbi8vIHJlbW92ZUFkZHJlc3MgPSBmb3J3YXJkKGFkZHJlc3MsIFJlbW92ZSlcbi8vXG4vLyBBYm92ZSBleGFtcGxlIGNyZWF0ZWQgYHJlbW92ZUFkZHJlc3NgIHRhZ3MgZWFjaCBtZXNzYWdlIHdpdGggYFJlbW92ZWAgdGFnXG4vLyBiZWZvcmUgZm9yd2FyZGluZyB0aGVtIHRvIGEgZ2VuZXJhbCBgYWRkcmVzc2AuXG5leHBvcnQgY29uc3QgZm9yd2FyZCA9IDxhLCBiPihcbiAgYWRkcmVzczogQWRkcmVzczxhPixcbiAgdGFnOiAodmFsdWU6IGIpID0+IGFcbik6IEFkZHJlc3M8Yj4gPT4ge1xuICAvLyBHZW5yYXRlIElEIGZvciBlYWNoIGFkZHJlc3MgdGhhdCBoYXMgYSBmb3J3YXJkaW5nIGFkZHJlc3NlcyBzbyB0aGF0XG4gIC8vIGZvcndhcmRpbmcgYWRkcmVzc2VzIGNvdWxkIGJlIGNhY2hlZCBieSB0aGF0IGlkIGFuZCBhIHRhZy1pbmcgZnVuY3Rpb24uXG4gIGNvbnN0IGlkID0gYWRkcmVzcy5pZCAhPSBudWxsXG4gICAgPyBhZGRyZXNzLmlkXG4gICAgOiAoYWRkcmVzcy5pZCA9IGdsb2JhbFtcInJlZmxleC9hZGRyZXNzXCJdKyspXG4gIGNvbnN0IGtleSA9IGByZWZsZXgvYWRkcmVzcy8ke2lkfWBcblxuICByZXR1cm4gdGFnW2tleV0gfHwgKHRhZ1trZXldID0gRm9yd2FyZChhZGRyZXNzLCB0YWcpKVxufVxuIl19
(function (global, factory) {
  if (typeof define === "function" && define.amd) {
    define(["exports", "./Effects"], factory);
  } else if (typeof exports !== "undefined") {
    factory(exports, require("./Effects"));
  } else {
    var mod = {
      exports: {}
    };
    factory(mod.exports, global.Effects);
    global.subscription = mod.exports;
  }
})(this, function (exports, _Effects) {
  "use strict";

  Object.defineProperty(exports, "__esModule", {
    value: true
  });
  exports.none = exports.batch = exports.subscription = undefined;


  class Subscription {
    map(tag) {
      return this.map(tag);
    }
    reduce(reducer, init) {
      return init;
    }
  }

  class Subscribe extends Subscription {
    constructor(feed, detail, decoder) {
      super();
      this.feed = feed;
      this.detail = detail;
      this.decoder = decoder;
    }
    map(tag) {
      const decoder = value => tag(this.decoder(value));
      return new Subscribe(this.feed, this.detail, decoder);
    }
    reduce(reducer, init) {
      return reducer(init, this);
    }

  }

  class Batch extends Subscription {
    constructor(subscriptions) {
      super();
      this.subscriptions = subscriptions;
    }
    map(tag) {
      const subscriptions = this.subscriptions.map($ => $.map(tag));
      return new Batch(subscriptions);
    }
    reduce(reducer, init) {
      return this.subscriptions.reduce((result, subscription) => subscription.reduce(reducer, result), init);
    }
  }

  const subscription = exports.subscription = (feed, detail, decoder) => new Subscribe(feed, detail, decoder);

  const batch = exports.batch = subscriptions => new Batch(subscriptions);

  const none = exports.none = new Batch([]);
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9zdWJzY3JpcHRpb24uanMiXSwibmFtZXMiOlsiU3Vic2NyaXB0aW9uIiwibWFwIiwidGFnIiwicmVkdWNlIiwicmVkdWNlciIsImluaXQiLCJTdWJzY3JpYmUiLCJjb25zdHJ1Y3RvciIsImZlZWQiLCJkZXRhaWwiLCJkZWNvZGVyIiwidmFsdWUiLCJCYXRjaCIsInN1YnNjcmlwdGlvbnMiLCIkIiwicmVzdWx0Iiwic3Vic2NyaXB0aW9uIiwiYmF0Y2giLCJub25lIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFtQkEsUUFBTUEsWUFBTixDQUFzQjtBQUNwQkMsUUFBT0MsR0FBUCxFQUE4QztBQUM1QyxhQUFPLEtBQUtELEdBQUwsQ0FBU0MsR0FBVCxDQUFQO0FBQ0Q7QUFDREMsV0FDRUMsT0FERixFQUVFQyxJQUZGLEVBR1M7QUFDUCxhQUFPQSxJQUFQO0FBQ0Q7QUFUbUI7O0FBWXRCLFFBQU1DLFNBQU4sU0FBaUROLFlBQWpELENBQWlFO0FBQy9ETyxnQkFDRUMsSUFERixFQUVFQyxNQUZGLEVBR0VDLE9BSEYsRUFJRTtBQUNBO0FBQ0EsV0FBS0YsSUFBTCxHQUFZQSxJQUFaO0FBQ0EsV0FBS0MsTUFBTCxHQUFjQSxNQUFkO0FBQ0EsV0FBS0MsT0FBTCxHQUFlQSxPQUFmO0FBQ0Q7QUFDRFQsUUFBT0MsR0FBUCxFQUE4QztBQUM1QyxZQUFNUSxVQUFXQyxLQUFELElBQWtCVCxJQUFJLEtBQUtRLE9BQUwsQ0FBYUMsS0FBYixDQUFKLENBQWxDO0FBQ0EsYUFBTyxJQUFJTCxTQUFKLENBQWMsS0FBS0UsSUFBbkIsRUFBeUIsS0FBS0MsTUFBOUIsRUFBc0NDLE9BQXRDLENBQVA7QUFDRDtBQUNEUCxXQUNFQyxPQURGLEVBS0VDLElBTEYsRUFNUztBQUNQLGFBQU9ELFFBQVFDLElBQVIsRUFBYyxJQUFkLENBQVA7QUFDRDs7QUF2QjhEOztBQThCakUsUUFBTU8sS0FBTixTQUF1QlosWUFBdkIsQ0FBdUM7QUFDckNPLGdCQUFZTSxhQUFaLEVBQW1EO0FBQ2pEO0FBQ0EsV0FBS0EsYUFBTCxHQUFxQkEsYUFBckI7QUFDRDtBQUNEWixRQUFPQyxHQUFQLEVBQThDO0FBQzVDLFlBQU1XLGdCQUFnQixLQUFLQSxhQUFMLENBQW1CWixHQUFuQixDQUF1QmEsS0FBS0EsRUFBRWIsR0FBRixDQUFNQyxHQUFOLENBQTVCLENBQXRCO0FBQ0EsYUFBTyxJQUFJVSxLQUFKLENBQVVDLGFBQVYsQ0FBUDtBQUNEO0FBQ0RWLFdBQ0VDLE9BREYsRUFFRUMsSUFGRixFQUdTO0FBQ1AsYUFBTyxLQUFLUSxhQUFMLENBQW1CVixNQUFuQixDQUNMLENBQUNZLE1BQUQsRUFBZ0JDLFlBQWhCLEtBQ0VBLGFBQWFiLE1BQWIsQ0FBb0JDLE9BQXBCLEVBQTZCVyxNQUE3QixDQUZHLEVBR0xWLElBSEssQ0FBUDtBQUtEO0FBbEJvQzs7QUFzQmhDLFFBQU1XLHNDQUFlLENBQzFCUixJQUQwQixFQUUxQkMsTUFGMEIsRUFHMUJDLE9BSDBCLEtBSU4sSUFBSUosU0FBSixDQUFjRSxJQUFkLEVBQW9CQyxNQUFwQixFQUE0QkMsT0FBNUIsQ0FKZjs7QUFNQSxRQUFNTyx3QkFDWEosYUFEbUIsSUFFQyxJQUFJRCxLQUFKLENBQVVDLGFBQVYsQ0FGZjs7QUFJQSxRQUFNSyxzQkFBMEIsSUFBSU4sS0FBSixDQUFVLEVBQVYsQ0FBaEMiLCJmaWxlIjoic3Vic2NyaXB0aW9uLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyogQGZsb3cgKi9cblxuaW1wb3J0IHsgRWZmZWN0cyB9IGZyb20gXCIuL0VmZmVjdHNcIlxuXG50eXBlIERlY29kZXI8YT4gPSAodmFsdWU6IG1peGVkKSA9PiBhXG5cbmV4cG9ydCB0eXBlIFNlcnZpY2U8bWVzc2FnZSwgYWN0aW9uLCBtb2RlbD4gPSB7XG4gIHN1YnNjcmlwdGlvbnM6IEFycmF5PFN1YnNjcmlwdGlvbjxtZXNzYWdlPj4sXG4gIHN0YXRlOiBtb2RlbCxcbiAgZmVlZDogRmVlZDxtZXNzYWdlLCBhY3Rpb24sIG1vZGVsPlxufVxuXG5leHBvcnQgaW50ZXJmYWNlIEZlZWQ8bWVzc2FnZSwgYWN0aW9uLCBtb2RlbD4ge1xuICBpbml0KCk6IG1vZGVsLFxuICBzdWJzY3JpYmUoc3Vic2NyaWJlcnM6IEFycmF5PGFjdGlvbj4pOiBhY3Rpb24sXG4gIHVwZGF0ZShzdGF0ZTogbW9kZWwsIHBheWxvYWQ6IGFjdGlvbik6IFttb2RlbCwgRWZmZWN0czxtZXNzYWdlPl0sXG4gIGFkZHJlc3M/OiBzdHJpbmdcbn1cblxuY2xhc3MgU3Vic2NyaXB0aW9uPGE+IHtcbiAgbWFwPGI+KHRhZzogKHZhbHVlOiBhKSA9PiBiKTogU3Vic2NyaXB0aW9uPGI+IHtcbiAgICByZXR1cm4gdGhpcy5tYXAodGFnKVxuICB9XG4gIHJlZHVjZTxzdGF0ZT4oXG4gICAgcmVkdWNlcjogKHJlc3VsdDogc3RhdGUsIGlucHV0OiBTdWJzY3JpYmU8YSwgYW55LCBhbnksIGFueT4pID0+IHN0YXRlLFxuICAgIGluaXQ6IHN0YXRlXG4gICk6IHN0YXRlIHtcbiAgICByZXR1cm4gaW5pdFxuICB9XG59XG5cbmNsYXNzIFN1YnNjcmliZTxhLCBpbmZvLCBtb2RlbCwgbWVzc2FnZT4gZXh0ZW5kcyBTdWJzY3JpcHRpb248YT4ge1xuICBjb25zdHJ1Y3RvcihcbiAgICBmZWVkOiBGZWVkPGluZm8sIG1vZGVsLCBtZXNzYWdlPixcbiAgICBkZXRhaWw6IGluZm8sXG4gICAgZGVjb2RlcjogRGVjb2RlcjxhPlxuICApIHtcbiAgICBzdXBlcigpXG4gICAgdGhpcy5mZWVkID0gZmVlZFxuICAgIHRoaXMuZGV0YWlsID0gZGV0YWlsXG4gICAgdGhpcy5kZWNvZGVyID0gZGVjb2RlclxuICB9XG4gIG1hcDxiPih0YWc6ICh2YWx1ZTogYSkgPT4gYik6IFN1YnNjcmlwdGlvbjxiPiB7XG4gICAgY29uc3QgZGVjb2RlciA9ICh2YWx1ZTogbWl4ZWQpID0+IHRhZyh0aGlzLmRlY29kZXIodmFsdWUpKVxuICAgIHJldHVybiBuZXcgU3Vic2NyaWJlKHRoaXMuZmVlZCwgdGhpcy5kZXRhaWwsIGRlY29kZXIpXG4gIH1cbiAgcmVkdWNlPHN0YXRlPihcbiAgICByZWR1Y2VyOiAoXG4gICAgICByZXN1bHQ6IHN0YXRlLFxuICAgICAgaW5wdXQ6IFN1YnNjcmliZTxhLCBpbmZvLCBtb2RlbCwgbWVzc2FnZT5cbiAgICApID0+IHN0YXRlLFxuICAgIGluaXQ6IHN0YXRlXG4gICk6IHN0YXRlIHtcbiAgICByZXR1cm4gcmVkdWNlcihpbml0LCB0aGlzKVxuICB9XG5cbiAgZmVlZDogRmVlZDxpbmZvLCBtb2RlbCwgbWVzc2FnZT5cbiAgZGV0YWlsOiBpbmZvXG4gIGRlY29kZXI6IERlY29kZXI8YT5cbn1cblxuY2xhc3MgQmF0Y2g8YT4gZXh0ZW5kcyBTdWJzY3JpcHRpb248YT4ge1xuICBjb25zdHJ1Y3RvcihzdWJzY3JpcHRpb25zOiBBcnJheTxTdWJzY3JpcHRpb248YT4+KSB7XG4gICAgc3VwZXIoKVxuICAgIHRoaXMuc3Vic2NyaXB0aW9ucyA9IHN1YnNjcmlwdGlvbnNcbiAgfVxuICBtYXA8Yj4odGFnOiAodmFsdWU6IGEpID0+IGIpOiBTdWJzY3JpcHRpb248Yj4ge1xuICAgIGNvbnN0IHN1YnNjcmlwdGlvbnMgPSB0aGlzLnN1YnNjcmlwdGlvbnMubWFwKCQgPT4gJC5tYXAodGFnKSlcbiAgICByZXR1cm4gbmV3IEJhdGNoKHN1YnNjcmlwdGlvbnMpXG4gIH1cbiAgcmVkdWNlPHN0YXRlPihcbiAgICByZWR1Y2VyOiAocmVzdWx0OiBzdGF0ZSwgaW5wdXQ6IFN1YnNjcmliZTxhLCBhbnksIGFueSwgYW55PikgPT4gc3RhdGUsXG4gICAgaW5pdDogc3RhdGVcbiAgKTogc3RhdGUge1xuICAgIHJldHVybiB0aGlzLnN1YnNjcmlwdGlvbnMucmVkdWNlKFxuICAgICAgKHJlc3VsdDogc3RhdGUsIHN1YnNjcmlwdGlvbjogU3Vic2NyaXB0aW9uPGE+KTogc3RhdGUgPT5cbiAgICAgICAgc3Vic2NyaXB0aW9uLnJlZHVjZShyZWR1Y2VyLCByZXN1bHQpLFxuICAgICAgaW5pdFxuICAgIClcbiAgfVxuICBzdWJzY3JpcHRpb25zOiBBcnJheTxTdWJzY3JpcHRpb248YT4+XG59XG5cbmV4cG9ydCBjb25zdCBzdWJzY3JpcHRpb24gPSA8aW5mbywgbW9kZWwsIG1lc3NhZ2UsIGE+KFxuICBmZWVkOiBGZWVkPGluZm8sIG1vZGVsLCBtZXNzYWdlPixcbiAgZGV0YWlsOiBpbmZvLFxuICBkZWNvZGVyOiBEZWNvZGVyPGE+XG4pOiBTdWJzY3JpcHRpb248YT4gPT4gbmV3IFN1YnNjcmliZShmZWVkLCBkZXRhaWwsIGRlY29kZXIpXG5cbmV4cG9ydCBjb25zdCBiYXRjaCA9IDxhPihcbiAgc3Vic2NyaXB0aW9uczogQXJyYXk8U3Vic2NyaXB0aW9uPGE+PlxuKTogU3Vic2NyaXB0aW9uPGE+ID0+IG5ldyBCYXRjaChzdWJzY3JpcHRpb25zKVxuXG5leHBvcnQgY29uc3Qgbm9uZTogU3Vic2NyaXB0aW9uPGFueT4gPSBuZXcgQmF0Y2goW10pXG5leHBvcnQgdHlwZSB7IFN1YnNjcmlwdGlvbiB9XG4iXX0=
(function (global, factory) {
  if (typeof define === "function" && define.amd) {
    define(["exports", "./preemptive-animation-frame"], factory);
  } else if (typeof exports !== "undefined") {
    factory(exports, require("./preemptive-animation-frame"));
  } else {
    var mod = {
      exports: {}
    };
    factory(mod.exports, global.preemptiveAnimationFrame);
    global.task = mod.exports;
  }
})(this, function (exports, _preemptiveAnimationFrame) {
  "use strict";

  Object.defineProperty(exports, "__esModule", {
    value: true
  });
  exports.Task = undefined;
  const raise = error => {
    throw Error(`Task was not supposet to never fail but it did fail with error ${error}`);
  };

  const ignore = _ => void 0;

  class Task {
    static create(execute) {
      console.warn("Task.create is deprecated API use new Task instead");
      return new Task(execute);
    }
    static future(request) {
      console.warn("Task.future is deprecated API use new Task instead");
      return new Future(request);
    }
    static succeed(value) {
      return new Succeed(value);
    }

    static fail(error) {
      return new Fail(error);
    }

    static spawn(task) {
      return new Spawn(task);
    }

    static sleep(time) {
      return new Sleep(time);
    }

    static requestAnimationFrame() {
      return new AnimationFrame();
    }

    static send(address, message) {
      return new Send(address, message);
    }

    static fork(task, onSucceed, onFail) {
      return Thread.fork(task, onSucceed, onFail);
    }

    static perform(task) {
      Thread.fork(task, ignore, raise);
    }

    constructor(execute, cancel) {
      this.type = "Task";
      const task = this;
      if (execute != null) {
        task.fork = execute;
      }
      if (cancel != null) {
        task.abort = cancel;
      }
    }
    chain(next) {
      return new Chain(this, next);
    }
    map(f) {
      return new Map(this, f);
    }
    capture(handle) {
      return new Capture(this, handle);
    }
    format(f) {
      return new Format(this, f);
    }
    recover(regain) {
      return new Recover(this, regain);
    }
    fork(succeed, fail) {
      return this.execute(succeed, fail);
    }
    abort(token) {
      return this.cancel(token);
    }

  }

  exports.Task = Task;
  class Succeed extends Task {
    constructor(value) {
      super();
      this.type = "Succeed";
      this.value = value;
    }
    fork(succeed, fail) {
      succeed(this.value);
    }

  }

  class Fail extends Task {
    constructor(error) {
      super();
      this.type = "Fail";
      this.error = error;
    }
    fork(succeed, fail) {
      fail(this.error);
    }

  }

  class Sleep extends Task {
    constructor(time) {
      super();
      this.time = time;
    }
    fork(succeed, fail) {
      return setTimeout(succeed, this.time, void 0);
    }
    abort(id) {
      clearTimeout(id);
    }

  }

  class AnimationFrame extends Task {
    constructor() {
      super();
    }
    fork(succeed, fail) {
      return (0, _preemptiveAnimationFrame.requestAnimationFrame)(succeed);
    }
    abort(id) {
      (0, _preemptiveAnimationFrame.cancelAnimationFrame)(id);
    }
  }

  let threadID = 0;
  class Spawn extends Task {
    constructor(task) {
      super();
      this.task = task;
    }
    fork(succeed, fail) {
      Promise.resolve(null).then(_ => Task.fork(this.task, noop, noop));

      succeed(++threadID);
    }

  }

  class Send extends Task {
    constructor(address, message) {
      super();
      this.message = message;
      this.address = address;
    }
    fork(succeed, fail) {
      succeed(void this.address(this.message));
    }

  }

  class Future extends Task {
    constructor(request) {
      super();
      this.request = request;
    }
    fork(succeed, fail) {
      this.request().then(succeed, fail);
    }

  }

  class Then extends Task {
    constructor(task) {
      super();
      this.type = "Then";
      this.task = task;
    }
    fork(succeed, fail) {
      this.task.fork(value => void this.next(value).fork(succeed, fail), fail);
    }
    next(input) {
      throw Error("Subclass of absract Then must implement next method");
    }

  }

  class Chain extends Then {
    constructor(task, next) {
      super(task);
      this.chainer = next;
    }
    next(input) {
      return this.chainer(input);
    }

  }

  class Map extends Then {
    constructor(task, mapper) {
      // Note: Had to trick flow into thinking that `Format.prototype.handle` was
      // passed, otherwise it fails to infer polymorphic nature.
      super(task);
      this.mapper = mapper;
    }
    next(input) {
      return new Succeed(this.mapper(input));
    }

  }

  class Catch extends Task {
    constructor(task) {
      super();
      this.type = "Catch";
      this.task = task;
    }
    fork(succeed, fail) {
      this.task.fork(succeed, error => void this.handle(error).fork(succeed, fail));
    }
    handle(error) {
      throw Error("Subclass of absract Catch must implement handle method");
    }

  }

  class Capture extends Catch {
    constructor(task, handle) {
      super(task);
      this.capturer = handle;
    }

    handle(error) {
      return this.capturer(error);
    }

  }

  class Recover extends Catch {
    constructor(task, regain) {
      super(task);
      this.regain = regain;
    }
    handle(error) {
      return new Succeed(this.regain(error));
    }

  }

  class Format extends Catch {
    constructor(task, formatter) {
      super(task);
      this.formatter = formatter;
    }
    handle(error) {
      return new Fail(this.formatter(error));
    }

  }

  const noop = () => void 0;

  let nextID = 0;

  class Thread {
    static fork(task, onSucceed, onFail) {
      const process = new Thread();
      process.id = ++nextID;
      process.position = 0;
      process.root = task;
      process.stack = [];
      process.mailbox = [];
      process.abortHandle = null;
      process.isActive = true;
      process.isPending = false;
      process.isPaused = true;
      process.success = null;
      process.failure = null;
      process.succeed = onSucceed;
      process.fail = onFail;
      process.onSucceed = process.onSucceed.bind(process);
      process.onFail = process.onFail.bind(process);
      process.schedule();
      return process;
    }
    onSucceed(ok) {
      if (this.isPending) {
        this.isPending = false;
        this.abortHandle = null;

        if (this.success != null) {
          this.success.value = ok;
        } else {
          this.success = new Succeed(ok);
        }

        this.root = this.success;
        this.schedule();
      }
    }
    onFail(failure) {
      if (this.isPending) {
        this.isPending = false;
        this.abortHandle = null;

        if (this.failure != null) {
          this.failure.error = failure;
        } else {
          this.failure = new Fail(failure);
        }

        this.root = this.failure;
        this.schedule();
      }
    }
    kill(exit) {
      if (this.isActive) {
        this.isActive = false;
        if (this.root.abort) {
          this.root.abort(this.abortHandle);
        }
      }
    }
    schedule() {
      if (this.isPaused) {
        this.isPaused = false;
        this.step();
      }
    }
    step() {
      const process = this;
      while (process.isActive) {
        const root = process.root;
        switch (root.type) {
          case "Succeed":
            {
              const task = root;
              // If task succeeded skip all the error handling.
              while (process.position < process.stack.length && process.stack[process.position] instanceof Catch) {
                process.position++;
              }

              // If end of the stack is reached then break
              if (process.position >= process.stack.length) {
                if (process.succeed != null) {
                  process.succeed(task.value);
                }
                return;
              }

              // Otherwise step into next task.
              const then = process.stack[process.position++];
              if (then instanceof Then) {
                process.root = then.next(task.value);
              }

              break;
            }
          case "Fail":
            {
              const task = root;
              // If task fails skip all the chaining.
              while (process.position < process.stack.length && process.stack[process.position] instanceof Then) {
                process.position++;
              }

              // If end of the stack is reached then break.
              if (this.position >= process.stack.length) {
                if (process.fail != null) {
                  process.fail(task.error);
                }

                return;
              }

              // Otherwise step into next task.
              const _catch = process.stack[process.position++];
              if (_catch instanceof Catch) {
                process.root = _catch.handle(task.error);
              }

              break;
            }
          case "Then":
            {
              const task = root;
              if (process.position === 0) {
                process.stack.unshift(task);
              } else {
                process.stack[--process.position] = task;
              }

              process.root = task.task;

              break;
            }
          case "Catch":
            {
              const task = root;
              if (process.position === 0) {
                process.stack.unshift(task);
              } else {
                process.stack[--process.position] = task;
              }

              process.root = task.task;

              break;
            }
          default:
            {
              const task = root;
              process.isPending = true;
              process.abortHandle = task.fork(process.onSucceed, process.onFail);
              process.isPaused = process.isPending;
              if (this.isPending) {
                return;
              }

              break;
            }
        }
      }
    }
  }
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy90YXNrLmpzIl0sIm5hbWVzIjpbInJhaXNlIiwiZXJyb3IiLCJFcnJvciIsImlnbm9yZSIsIl8iLCJUYXNrIiwiY3JlYXRlIiwiZXhlY3V0ZSIsImNvbnNvbGUiLCJ3YXJuIiwiZnV0dXJlIiwicmVxdWVzdCIsIkZ1dHVyZSIsInN1Y2NlZWQiLCJ2YWx1ZSIsIlN1Y2NlZWQiLCJmYWlsIiwiRmFpbCIsInNwYXduIiwidGFzayIsIlNwYXduIiwic2xlZXAiLCJ0aW1lIiwiU2xlZXAiLCJyZXF1ZXN0QW5pbWF0aW9uRnJhbWUiLCJBbmltYXRpb25GcmFtZSIsInNlbmQiLCJhZGRyZXNzIiwibWVzc2FnZSIsIlNlbmQiLCJmb3JrIiwib25TdWNjZWVkIiwib25GYWlsIiwiVGhyZWFkIiwicGVyZm9ybSIsImNvbnN0cnVjdG9yIiwiY2FuY2VsIiwidHlwZSIsImFib3J0IiwiY2hhaW4iLCJuZXh0IiwiQ2hhaW4iLCJtYXAiLCJmIiwiTWFwIiwiY2FwdHVyZSIsImhhbmRsZSIsIkNhcHR1cmUiLCJmb3JtYXQiLCJGb3JtYXQiLCJyZWNvdmVyIiwicmVnYWluIiwiUmVjb3ZlciIsInRva2VuIiwic2V0VGltZW91dCIsImlkIiwiY2xlYXJUaW1lb3V0IiwidGhyZWFkSUQiLCJQcm9taXNlIiwicmVzb2x2ZSIsInRoZW4iLCJub29wIiwiVGhlbiIsImlucHV0IiwiY2hhaW5lciIsIm1hcHBlciIsIkNhdGNoIiwiY2FwdHVyZXIiLCJmb3JtYXR0ZXIiLCJuZXh0SUQiLCJwcm9jZXNzIiwicG9zaXRpb24iLCJyb290Iiwic3RhY2siLCJtYWlsYm94IiwiYWJvcnRIYW5kbGUiLCJpc0FjdGl2ZSIsImlzUGVuZGluZyIsImlzUGF1c2VkIiwic3VjY2VzcyIsImZhaWx1cmUiLCJiaW5kIiwic2NoZWR1bGUiLCJvayIsImtpbGwiLCJleGl0Iiwic3RlcCIsImxlbmd0aCIsIl9jYXRjaCIsInVuc2hpZnQiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7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S0FBS2xCLEtBQW5CLENBQWY7QUFDRDs7QUFFRDtBQUNEO0FBQ0QsZUFBSyxNQUFMO0FBQWE7QUFDWCxvQkFBTWtCLE9BQXVCcUQsSUFBN0I7QUFDQSxrQkFBSUYsUUFBUUMsUUFBUixLQUFxQixDQUF6QixFQUE0QjtBQUMxQkQsd0JBQVFHLEtBQVIsQ0FBY2dCLE9BQWQsQ0FBc0J0RSxJQUF0QjtBQUNELGVBRkQsTUFFTztBQUNMbUQsd0JBQVFHLEtBQVIsQ0FBYyxFQUFFSCxRQUFRQyxRQUF4QixJQUFvQ3BELElBQXBDO0FBQ0Q7O0FBRURtRCxzQkFBUUUsSUFBUixHQUFlckQsS0FBS0EsSUFBcEI7O0FBRUE7QUFDRDtBQUNELGVBQUssT0FBTDtBQUFjO0FBQ1osb0JBQU1BLE9BQXdCcUQsSUFBOUI7QUFDQSxrQkFBSUYsUUFBUUMsUUFBUixLQUFxQixDQUF6QixFQUE0QjtBQUMxQkQsd0JBQVFHLEtBQVIsQ0FBY2dCLE9BQWQsQ0FBc0J0RSxJQUF0QjtBQUNELGVBRkQsTUFFTztBQUNMbUQsd0JBQVFHLEtBQVIsQ0FBYyxFQUFFSCxRQUFRQyxRQUF4QixJQUFvQ3BELElBQXBDO0FBQ0Q7O0FBRURtRCxzQkFBUUUsSUFBUixHQUFlckQsS0FBS0EsSUFBcEI7O0FBRUE7QUFDRDtBQUNEO0FBQVM7QUFDUCxvQkFBTUEsT0FBT3FELElBQWI7QUFDQUYsc0JBQVFPLFNBQVIsR0FBb0IsSUFBcEI7QUFDQVAsc0JBQVFLLFdBQVIsR0FBc0J4RCxLQUFLVyxJQUFMLENBQVV3QyxRQUFRdkMsU0FBbEIsRUFBNkJ1QyxRQUFRdEMsTUFBckMsQ0FBdEI7QUFDQXNDLHNCQUFRUSxRQUFSLEdBQW1CUixRQUFRTyxTQUEzQjtBQUNBLGtCQUFJLEtBQUtBLFNBQVQsRUFBb0I7QUFDbEI7QUFDRDs7QUFFRDtBQUNEO0FBeEZIO0FBMEZEO0FBQ0Y7QUFuTHlDIiwiZmlsZSI6InRhc2suanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKiBAZmxvdyAqL1xuXG5pbXBvcnQgdHlwZSB7IEFkZHJlc3MgfSBmcm9tIFwiLi9kcml2ZXJcIlxuaW1wb3J0IHtcbiAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lLFxuICBjYW5jZWxBbmltYXRpb25GcmFtZVxufSBmcm9tIFwiLi9wcmVlbXB0aXZlLWFuaW1hdGlvbi1mcmFtZVwiXG5cbmV4cG9ydCB0eXBlIFRocmVhZElEID0gbnVtYmVyXG5leHBvcnQgdHlwZSBUaW1lID0gbnVtYmVyXG5leHBvcnQgdHlwZSBQcm9jZXNzSUQgPSBudW1iZXJcbmV4cG9ydCB0eXBlIE5ldmVyID0gbnVtYmVyICYgc3RyaW5nXG5cbmNvbnN0IHJhaXNlID0gZXJyb3IgPT4ge1xuICB0aHJvdyBFcnJvcihcbiAgICBgVGFzayB3YXMgbm90IHN1cHBvc2V0IHRvIG5ldmVyIGZhaWwgYnV0IGl0IGRpZCBmYWlsIHdpdGggZXJyb3IgJHtlcnJvcn1gXG4gIClcbn1cblxuY29uc3QgaWdub3JlID0gXyA9PiB2b2lkIDBcblxuZXhwb3J0IGludGVyZmFjZSBQcm9jZXNzPGVycm9yLCB2YWx1ZSwgbWVzc2FnZSwgcmVhc29uPiB7XG4gIGlkOiBQcm9jZXNzSUQsXG4gIGlzQWN0aXZlOiBib29sZWFuLFxuICBraWxsKHJlc29uOiByZWFzb24pOiB2b2lkXG59XG5cbmV4cG9ydCBjbGFzcyBUYXNrPHgsIGE+IHtcbiAgc3RhdGljIGNyZWF0ZTx4LCBhPihcbiAgICBleGVjdXRlOiAoc3VjY2VlZDogKGE6IGEpID0+IHZvaWQsIGZhaWw6ICh4OiB4KSA9PiB2b2lkKSA9PiB2b2lkXG4gICk6IFRhc2s8eCwgYT4ge1xuICAgIGNvbnNvbGUud2FybihcIlRhc2suY3JlYXRlIGlzIGRlcHJlY2F0ZWQgQVBJIHVzZSBuZXcgVGFzayBpbnN0ZWFkXCIpXG4gICAgcmV0dXJuIG5ldyBUYXNrKGV4ZWN1dGUpXG4gIH1cbiAgc3RhdGljIGZ1dHVyZTx4LCBhPihyZXF1ZXN0OiAoKSA9PiBQcm9taXNlPGE+KTogVGFzazx4LCBhPiB7XG4gICAgY29uc29sZS53YXJuKFwiVGFzay5mdXR1cmUgaXMgZGVwcmVjYXRlZCBBUEkgdXNlIG5ldyBUYXNrIGluc3RlYWRcIilcbiAgICByZXR1cm4gbmV3IEZ1dHVyZShyZXF1ZXN0KVxuICB9XG4gIHN0YXRpYyBzdWNjZWVkPHgsIGE+KHZhbHVlOiBhKTogVGFzazx4LCBhPiB7XG4gICAgcmV0dXJuIG5ldyBTdWNjZWVkKHZhbHVlKVxuICB9XG5cbiAgc3RhdGljIGZhaWw8eCwgYT4oZXJyb3I6IHgpOiBUYXNrPHgsIGE+IHtcbiAgICByZXR1cm4gbmV3IEZhaWwoZXJyb3IpXG4gIH1cblxuICBzdGF0aWMgc3Bhd248eCwgeSwgYT4odGFzazogVGFzazx4LCBhPik6IFRhc2s8eSwgVGhyZWFkSUQ+IHtcbiAgICByZXR1cm4gbmV3IFNwYXduKHRhc2spXG4gIH1cblxuICBzdGF0aWMgc2xlZXA8eD4odGltZTogVGltZSk6IFRhc2s8eCwgdm9pZD4ge1xuICAgIHJldHVybiBuZXcgU2xlZXAodGltZSlcbiAgfVxuXG4gIHN0YXRpYyByZXF1ZXN0QW5pbWF0aW9uRnJhbWU8eD4oKTogVGFzazx4LCBUaW1lPiB7XG4gICAgcmV0dXJuIG5ldyBBbmltYXRpb25GcmFtZSgpXG4gIH1cblxuICBzdGF0aWMgc2VuZDx4LCBhPihhZGRyZXNzOiBBZGRyZXNzPGE+LCBtZXNzYWdlOiBhKTogVGFzazx4LCB2b2lkPiB7XG4gICAgcmV0dXJuIG5ldyBTZW5kKGFkZHJlc3MsIG1lc3NhZ2UpXG4gIH1cblxuICBzdGF0aWMgZm9yazx4LCBhLCBtZXNzYWdlLCByZWFzb24+KFxuICAgIHRhc2s6IFRhc2s8eCwgYT4sXG4gICAgb25TdWNjZWVkOiAoYTogYSkgPT4gdm9pZCxcbiAgICBvbkZhaWw6ICh4OiB4KSA9PiB2b2lkXG4gICk6IFByb2Nlc3M8eCwgYSwgbWVzc2FnZSwgcmVhc29uPiB7XG4gICAgcmV0dXJuIFRocmVhZC5mb3JrKHRhc2ssIG9uU3VjY2VlZCwgb25GYWlsKVxuICB9XG5cbiAgc3RhdGljIHBlcmZvcm0odGFzazogVGFzazxOZXZlciwgdm9pZD4pOiB2b2lkIHtcbiAgICBUaHJlYWQuZm9yayh0YXNrLCBpZ25vcmUsIHJhaXNlKVxuICB9XG5cbiAgY29uc3RydWN0b3I8aGFuZGxlPihcbiAgICBleGVjdXRlOiA/KHN1Y2NlZWQ6IChhOiBhKSA9PiB2b2lkLCBmYWlsOiAoeDogeCkgPT4gdm9pZCkgPT4gaGFuZGxlLFxuICAgIGNhbmNlbDogPyhoYW5kbGU6IGhhbmRsZSkgPT4gdm9pZFxuICApIHtcbiAgICB0aGlzLnR5cGUgPSBcIlRhc2tcIlxuICAgIGNvbnN0IHRhc2sgPSAodGhpczogYW55KVxuICAgIGlmIChleGVjdXRlICE9IG51bGwpIHtcbiAgICAgIHRhc2suZm9yayA9IGV4ZWN1dGVcbiAgICB9XG4gICAgaWYgKGNhbmNlbCAhPSBudWxsKSB7XG4gICAgICB0YXNrLmFib3J0ID0gY2FuY2VsXG4gICAgfVxuICB9XG4gIGNoYWluPGI+KG5leHQ6IChhOiBhKSA9PiBUYXNrPHgsIGI+KTogVGFzazx4LCBiPiB7XG4gICAgcmV0dXJuIG5ldyBDaGFpbih0aGlzLCBuZXh0KVxuICB9XG4gIG1hcDxiPihmOiAoaW5wdXQ6IGEpID0+IGIpOiBUYXNrPHgsIGI+IHtcbiAgICByZXR1cm4gbmV3IE1hcCh0aGlzLCBmKVxuICB9XG4gIGNhcHR1cmU8eT4oaGFuZGxlOiAoZXJyb3I6IHgpID0+IFRhc2s8eSwgYT4pOiBUYXNrPHksIGE+IHtcbiAgICByZXR1cm4gbmV3IENhcHR1cmUodGhpcywgaGFuZGxlKVxuICB9XG4gIGZvcm1hdDx5PihmOiAoaW5wdXQ6IHgpID0+IHkpOiBUYXNrPHksIGE+IHtcbiAgICByZXR1cm4gbmV3IEZvcm1hdCh0aGlzLCBmKVxuICB9XG4gIHJlY292ZXI8eT4ocmVnYWluOiAoZXJyb3I6IHgpID0+IGEpOiBUYXNrPHksIGE+IHtcbiAgICByZXR1cm4gbmV3IFJlY292ZXIodGhpcywgcmVnYWluKVxuICB9XG4gIGZvcmsoc3VjY2VlZDogKGE6IGEpID0+IHZvaWQsIGZhaWw6ICh4OiB4KSA9PiB2b2lkKTogKiB7XG4gICAgcmV0dXJuIHRoaXMuZXhlY3V0ZShzdWNjZWVkLCBmYWlsKVxuICB9XG4gIGFib3J0KHRva2VuOiAqKTogdm9pZCB7XG4gICAgcmV0dXJuIHRoaXMuY2FuY2VsKHRva2VuKVxuICB9XG5cbiAgdHlwZTogKlxuICBleGVjdXRlOiAoc3VjY2VlZDogKGE6IGEpID0+IHZvaWQsIGZhaWw6ICh4OiB4KSA9PiB2b2lkKSA9PiAqXG4gIGNhbmNlbDogKGhhbmRsZTogKikgPT4gdm9pZFxufVxuXG5jbGFzcyBTdWNjZWVkPHgsIGE+IGV4dGVuZHMgVGFzazx4LCBhPiB7XG4gIGNvbnN0cnVjdG9yKHZhbHVlOiBhKSB7XG4gICAgc3VwZXIoKVxuICAgIHRoaXMudHlwZSA9IFwiU3VjY2VlZFwiXG4gICAgdGhpcy52YWx1ZSA9IHZhbHVlXG4gIH1cbiAgZm9yayhzdWNjZWVkOiAoYTogYSkgPT4gdm9pZCwgZmFpbDogKHg6IHgpID0+IHZvaWQpOiB2b2lkIHtcbiAgICBzdWNjZWVkKHRoaXMudmFsdWUpXG4gIH1cblxuICB0eXBlOiBcIlN1Y2NlZWRcIlxuICB2YWx1ZTogYVxufVxuXG5jbGFzcyBGYWlsPHgsIGE+IGV4dGVuZHMgVGFzazx4LCBhPiB7XG4gIGNvbnN0cnVjdG9yKGVycm9yOiB4KSB7XG4gICAgc3VwZXIoKVxuICAgIHRoaXMudHlwZSA9IFwiRmFpbFwiXG4gICAgdGhpcy5lcnJvciA9IGVycm9yXG4gIH1cbiAgZm9yayhzdWNjZWVkOiAoYTogYSkgPT4gdm9pZCwgZmFpbDogKHg6IHgpID0+IHZvaWQpOiB2b2lkIHtcbiAgICBmYWlsKHRoaXMuZXJyb3IpXG4gIH1cblxuICB0eXBlOiBcIkZhaWxcIlxuICBlcnJvcjogeFxufVxuXG5jbGFzcyBTbGVlcDx4LCBhOiB2b2lkPiBleHRlbmRzIFRhc2s8eCwgdm9pZD4ge1xuICBjb25zdHJ1Y3Rvcih0aW1lOiBUaW1lKSB7XG4gICAgc3VwZXIoKVxuICAgIHRoaXMudGltZSA9IHRpbWVcbiAgfVxuICBmb3JrKHN1Y2NlZWQ6IChhOiBhKSA9PiB2b2lkLCBmYWlsOiAoeDogeCkgPT4gdm9pZCk6IG51bWJlciB7XG4gICAgcmV0dXJuIHNldFRpbWVvdXQoc3VjY2VlZCwgdGhpcy50aW1lLCB2b2lkIDApXG4gIH1cbiAgYWJvcnQoaWQ6IG51bWJlcik6IHZvaWQge1xuICAgIGNsZWFyVGltZW91dChpZClcbiAgfVxuXG4gIHRpbWU6IFRpbWVcbn1cblxuY2xhc3MgQW5pbWF0aW9uRnJhbWU8eD4gZXh0ZW5kcyBUYXNrPHgsIFRpbWU+IHtcbiAgY29uc3RydWN0b3IoKSB7XG4gICAgc3VwZXIoKVxuICB9XG4gIGZvcmsoc3VjY2VlZDogKGE6IFRpbWUpID0+IHZvaWQsIGZhaWw6ICh4OiB4KSA9PiB2b2lkKTogbnVtYmVyIHtcbiAgICByZXR1cm4gcmVxdWVzdEFuaW1hdGlvbkZyYW1lKHN1Y2NlZWQpXG4gIH1cbiAgYWJvcnQoaWQ6IG51bWJlcik6IHZvaWQge1xuICAgIGNhbmNlbEFuaW1hdGlvbkZyYW1lKGlkKVxuICB9XG59XG5cbmxldCB0aHJlYWRJRCA9IDBcbmNsYXNzIFNwYXduPHgsIHksIGE+IGV4dGVuZHMgVGFzazx5LCBUaHJlYWRJRD4ge1xuICBjb25zdHJ1Y3Rvcih0YXNrOiBUYXNrPHgsIGE+KSB7XG4gICAgc3VwZXIoKVxuICAgIHRoaXMudGFzayA9IHRhc2tcbiAgfVxuICBmb3JrKHN1Y2NlZWQ6IChhOiBUaHJlYWRJRCkgPT4gdm9pZCwgZmFpbDogKHg6IHkpID0+IHZvaWQpOiB2b2lkIHtcbiAgICBQcm9taXNlLnJlc29sdmUobnVsbCkudGhlbihfID0+IFRhc2suZm9yayh0aGlzLnRhc2ssIG5vb3AsIG5vb3ApKVxuXG4gICAgc3VjY2VlZCgrK3RocmVhZElEKVxuICB9XG5cbiAgdGFzazogVGFzazx4LCBhPlxufVxuXG5jbGFzcyBTZW5kPHgsIGE+IGV4dGVuZHMgVGFzazx4LCB2b2lkPiB7XG4gIGNvbnN0cnVjdG9yKGFkZHJlc3M6IEFkZHJlc3M8YT4sIG1lc3NhZ2U6IGEpIHtcbiAgICBzdXBlcigpXG4gICAgdGhpcy5tZXNzYWdlID0gbWVzc2FnZVxuICAgIHRoaXMuYWRkcmVzcyA9IGFkZHJlc3NcbiAgfVxuICBmb3JrKHN1Y2NlZWQ6IChhOiB2b2lkKSA9PiB2b2lkLCBmYWlsOiAoeDogeCkgPT4gdm9pZCk6IHZvaWQge1xuICAgIHN1Y2NlZWQodm9pZCB0aGlzLmFkZHJlc3ModGhpcy5tZXNzYWdlKSlcbiAgfVxuXG4gIG1lc3NhZ2U6IGFcbiAgYWRkcmVzczogQWRkcmVzczxhPlxufVxuXG5jbGFzcyBGdXR1cmU8eCwgYT4gZXh0ZW5kcyBUYXNrPHgsIGE+IHtcbiAgY29uc3RydWN0b3IocmVxdWVzdDogKCkgPT4gUHJvbWlzZTxhPikge1xuICAgIHN1cGVyKClcbiAgICB0aGlzLnJlcXVlc3QgPSByZXF1ZXN0XG4gIH1cbiAgZm9yayhzdWNjZWVkOiAoYTogYSkgPT4gdm9pZCwgZmFpbDogKHg6IHgpID0+IHZvaWQpOiB2b2lkIHtcbiAgICB0aGlzLnJlcXVlc3QoKS50aGVuKHN1Y2NlZWQsIGZhaWwpXG4gIH1cblxuICByZXF1ZXN0OiAoKSA9PiBQcm9taXNlPGE+XG59XG5cbmNsYXNzIFRoZW48eCwgYSwgYj4gZXh0ZW5kcyBUYXNrPHgsIGI+IHtcbiAgY29uc3RydWN0b3IodGFzazogVGFzazx4LCBhPikge1xuICAgIHN1cGVyKClcbiAgICB0aGlzLnR5cGUgPSBcIlRoZW5cIlxuICAgIHRoaXMudGFzayA9IHRhc2tcbiAgfVxuICBmb3JrKHN1Y2NlZWQ6ICh2YWx1ZTogYikgPT4gdm9pZCwgZmFpbDogKGVycm9yOiB4KSA9PiB2b2lkKTogdm9pZCB7XG4gICAgdGhpcy50YXNrLmZvcmsoXG4gICAgICAodmFsdWU6IGEpOiB2b2lkID0+IHZvaWQgdGhpcy5uZXh0KHZhbHVlKS5mb3JrKHN1Y2NlZWQsIGZhaWwpLFxuICAgICAgZmFpbFxuICAgIClcbiAgfVxuICBuZXh0KGlucHV0OiBhKTogVGFzazx4LCBiPiB7XG4gICAgdGhyb3cgRXJyb3IoXCJTdWJjbGFzcyBvZiBhYnNyYWN0IFRoZW4gbXVzdCBpbXBsZW1lbnQgbmV4dCBtZXRob2RcIilcbiAgfVxuXG4gIHR5cGU6IFwiVGhlblwiXG4gIHRhc2s6IFRhc2s8eCwgYT5cbn1cblxuY2xhc3MgQ2hhaW48eCwgYSwgYj4gZXh0ZW5kcyBUaGVuPHgsIGEsIGI+IHtcbiAgY29uc3RydWN0b3IodGFzazogVGFzazx4LCBhPiwgbmV4dDogKGlucHV0OiBhKSA9PiBUYXNrPHgsIGI+KSB7XG4gICAgc3VwZXIodGFzaylcbiAgICB0aGlzLmNoYWluZXIgPSBuZXh0XG4gIH1cbiAgbmV4dChpbnB1dDogYSk6IFRhc2s8eCwgYj4ge1xuICAgIHJldHVybiB0aGlzLmNoYWluZXIoaW5wdXQpXG4gIH1cblxuICBjaGFpbmVyOiAoaW5wdXQ6IGEpID0+IFRhc2s8eCwgYj5cbn1cblxuY2xhc3MgTWFwPHgsIGEsIGI+IGV4dGVuZHMgVGhlbjx4LCBhLCBiPiB7XG4gIGNvbnN0cnVjdG9yKHRhc2s6IFRhc2s8eCwgYT4sIG1hcHBlcjogKGlucHV0OiBhKSA9PiBiKSB7XG4gICAgLy8gTm90ZTogSGFkIHRvIHRyaWNrIGZsb3cgaW50byB0aGlua2luZyB0aGF0IGBGb3JtYXQucHJvdG90eXBlLmhhbmRsZWAgd2FzXG4gICAgLy8gcGFzc2VkLCBvdGhlcndpc2UgaXQgZmFpbHMgdG8gaW5mZXIgcG9seW1vcnBoaWMgbmF0dXJlLlxuICAgIHN1cGVyKHRhc2spXG4gICAgdGhpcy5tYXBwZXIgPSBtYXBwZXJcbiAgfVxuICBuZXh0KGlucHV0OiBhKTogVGFzazx4LCBiPiB7XG4gICAgcmV0dXJuIG5ldyBTdWNjZWVkKHRoaXMubWFwcGVyKGlucHV0KSlcbiAgfVxuXG4gIG1hcHBlcjogKGlucHV0OiBhKSA9PiBiXG59XG5cbmNsYXNzIENhdGNoPHgsIHksIGE+IGV4dGVuZHMgVGFzazx5LCBhPiB7XG4gIGNvbnN0cnVjdG9yKHRhc2s6IFRhc2s8eCwgYT4pIHtcbiAgICBzdXBlcigpXG4gICAgdGhpcy50eXBlID0gXCJDYXRjaFwiXG4gICAgdGhpcy50YXNrID0gdGFza1xuICB9XG4gIGZvcmsoc3VjY2VlZDogKHZhbHVlOiBhKSA9PiB2b2lkLCBmYWlsOiAoZXJyb3I6IHkpID0+IHZvaWQpOiB2b2lkIHtcbiAgICB0aGlzLnRhc2suZm9yayhcbiAgICAgIHN1Y2NlZWQsXG4gICAgICBlcnJvciA9PiB2b2lkIHRoaXMuaGFuZGxlKGVycm9yKS5mb3JrKHN1Y2NlZWQsIGZhaWwpXG4gICAgKVxuICB9XG4gIGhhbmRsZShlcnJvcjogeCk6IFRhc2s8eSwgYT4ge1xuICAgIHRocm93IEVycm9yKFwiU3ViY2xhc3Mgb2YgYWJzcmFjdCBDYXRjaCBtdXN0IGltcGxlbWVudCBoYW5kbGUgbWV0aG9kXCIpXG4gIH1cblxuICB0eXBlOiBcIkNhdGNoXCJcbiAgdGFzazogVGFzazx4LCBhPlxufVxuXG5jbGFzcyBDYXB0dXJlPHgsIHksIGE+IGV4dGVuZHMgQ2F0Y2g8eCwgeSwgYT4ge1xuICBjb25zdHJ1Y3Rvcih0YXNrOiBUYXNrPHgsIGE+LCBoYW5kbGU6IChlcnJvcjogeCkgPT4gVGFzazx5LCBhPikge1xuICAgIHN1cGVyKHRhc2spXG4gICAgdGhpcy5jYXB0dXJlciA9IGhhbmRsZVxuICB9XG5cbiAgaGFuZGxlKGVycm9yOiB4KTogVGFzazx5LCBhPiB7XG4gICAgcmV0dXJuIHRoaXMuY2FwdHVyZXIoZXJyb3IpXG4gIH1cblxuICBjYXB0dXJlcjogKGVycm9yOiB4KSA9PiBUYXNrPHksIGE+XG59XG5cbmNsYXNzIFJlY292ZXI8eCwgeSwgYT4gZXh0ZW5kcyBDYXRjaDx4LCB5LCBhPiB7XG4gIGNvbnN0cnVjdG9yKHRhc2s6IFRhc2s8eCwgYT4sIHJlZ2FpbjogKGVycm9yOiB4KSA9PiBhKSB7XG4gICAgc3VwZXIodGFzaylcbiAgICB0aGlzLnJlZ2FpbiA9IHJlZ2FpblxuICB9XG4gIGhhbmRsZShlcnJvcjogeCk6IFRhc2s8eSwgYT4ge1xuICAgIHJldHVybiBuZXcgU3VjY2VlZCh0aGlzLnJlZ2FpbihlcnJvcikpXG4gIH1cblxuICByZWdhaW46IChlcnJvcjogeCkgPT4gYVxufVxuXG5jbGFzcyBGb3JtYXQ8eCwgeSwgYT4gZXh0ZW5kcyBDYXRjaDx4LCB5LCBhPiB7XG4gIGNvbnN0cnVjdG9yKHRhc2s6IFRhc2s8eCwgYT4sIGZvcm1hdHRlcjogKGVycm9yOiB4KSA9PiB5KSB7XG4gICAgc3VwZXIodGFzaylcbiAgICB0aGlzLmZvcm1hdHRlciA9IGZvcm1hdHRlclxuICB9XG4gIGhhbmRsZShlcnJvcjogeCk6IFRhc2s8eSwgYT4ge1xuICAgIHJldHVybiBuZXcgRmFpbCh0aGlzLmZvcm1hdHRlcihlcnJvcikpXG4gIH1cblxuICBmb3JtYXR0ZXI6IChlcnJvcjogeCkgPT4geVxufVxuXG5jb25zdCBub29wID0gKCkgPT4gdm9pZCAwXG5cbmxldCBuZXh0SUQgPSAwXG5cbnR5cGUgUm9vdDx4LCBhPiA9XG4gIHwgU3VjY2VlZDx4LCBhPlxuICB8IEZhaWw8eCwgYT5cbiAgfCBUaGVuPHgsICosIGE+XG4gIHwgQ2F0Y2g8KiwgeCwgYT5cbiAgfCBUYXNrPHgsIGE+XG5cbmNsYXNzIFRocmVhZDxlcnJvciwgdmFsdWUsIG1lc3NhZ2UsIHJlYXNvbj4ge1xuICBpZDogUHJvY2Vzc0lEXG4gIHJvb3Q6IFJvb3Q8KiwgKj5cbiAgc3RhY2s6IEFycmF5PENhdGNoPCosICosICo+IHwgVGhlbjwqLCAqLCAqPj5cbiAgcG9zaXRpb246IG51bWJlclxuICBtYWlsYm94OiBBcnJheTxtZXNzYWdlPlxuICBhYm9ydEhhbmRsZTogKlxuICBpc0FjdGl2ZTogYm9vbGVhblxuICBzdWNjZWVkOiAoaW5wdXQ6IHZhbHVlKSA9PiB2b2lkXG4gIGZhaWw6IChlcnJvcjogZXJyb3IpID0+IHZvaWRcbiAgaXNQZW5kaW5nOiBib29sZWFuXG4gIGlzUGF1c2VkOiBib29sZWFuXG4gIHN1Y2Nlc3M6ID9TdWNjZWVkPCosICo+XG4gIGZhaWx1cmU6ID9GYWlsPCosICo+XG4gIG9uU3VjY2VlZDogPHZhbHVlPihpbnB1dDogdmFsdWUpID0+IHZvaWRcbiAgb25GYWlsOiA8ZXJyb3I+KGVycm9yOiBlcnJvcikgPT4gdm9pZFxuICBzdGF0aWMgZm9yazxlcnJvciwgdmFsdWUsIG1lc3NhZ2UsIHJlYXNvbj4oXG4gICAgdGFzazogVGFzazxlcnJvciwgdmFsdWU+LFxuICAgIG9uU3VjY2VlZDogKGlucHV0OiB2YWx1ZSkgPT4gdm9pZCxcbiAgICBvbkZhaWw6IChlcnJvcjogZXJyb3IpID0+IHZvaWRcbiAgKTogUHJvY2VzczxlcnJvciwgdmFsdWUsIG1lc3NhZ2UsIHJlYXNvbj4ge1xuICAgIGNvbnN0IHByb2Nlc3MgPSBuZXcgVGhyZWFkKClcbiAgICBwcm9jZXNzLmlkID0gKytuZXh0SURcbiAgICBwcm9jZXNzLnBvc2l0aW9uID0gMFxuICAgIHByb2Nlc3Mucm9vdCA9IHRhc2tcbiAgICBwcm9jZXNzLnN0YWNrID0gW11cbiAgICBwcm9jZXNzLm1haWxib3ggPSBbXVxuICAgIHByb2Nlc3MuYWJvcnRIYW5kbGUgPSBudWxsXG4gICAgcHJvY2Vzcy5pc0FjdGl2ZSA9IHRydWVcbiAgICBwcm9jZXNzLmlzUGVuZGluZyA9IGZhbHNlXG4gICAgcHJvY2Vzcy5pc1BhdXNlZCA9IHRydWVcbiAgICBwcm9jZXNzLnN1Y2Nlc3MgPSBudWxsXG4gICAgcHJvY2Vzcy5mYWlsdXJlID0gbnVsbFxuICAgIHByb2Nlc3Muc3VjY2VlZCA9IG9uU3VjY2VlZFxuICAgIHByb2Nlc3MuZmFpbCA9IG9uRmFpbFxuICAgIHByb2Nlc3Mub25TdWNjZWVkID0gcHJvY2Vzcy5vblN1Y2NlZWQuYmluZChwcm9jZXNzKVxuICAgIHByb2Nlc3Mub25GYWlsID0gcHJvY2Vzcy5vbkZhaWwuYmluZChwcm9jZXNzKVxuICAgIHByb2Nlc3Muc2NoZWR1bGUoKVxuICAgIHJldHVybiBwcm9jZXNzXG4gIH1cbiAgb25TdWNjZWVkKG9rKSB7XG4gICAgaWYgKHRoaXMuaXNQZW5kaW5nKSB7XG4gICAgICB0aGlzLmlzUGVuZGluZyA9IGZhbHNlXG4gICAgICB0aGlzLmFib3J0SGFuZGxlID0gbnVsbFxuXG4gICAgICBpZiAodGhpcy5zdWNjZXNzICE9IG51bGwpIHtcbiAgICAgICAgdGhpcy5zdWNjZXNzLnZhbHVlID0gb2tcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuc3VjY2VzcyA9IG5ldyBTdWNjZWVkKG9rKVxuICAgICAgfVxuXG4gICAgICB0aGlzLnJvb3QgPSB0aGlzLnN1Y2Nlc3NcbiAgICAgIHRoaXMuc2NoZWR1bGUoKVxuICAgIH1cbiAgfVxuICBvbkZhaWwoZmFpbHVyZSkge1xuICAgIGlmICh0aGlzLmlzUGVuZGluZykge1xuICAgICAgdGhpcy5pc1BlbmRpbmcgPSBmYWxzZVxuICAgICAgdGhpcy5hYm9ydEhhbmRsZSA9IG51bGxcblxuICAgICAgaWYgKHRoaXMuZmFpbHVyZSAhPSBudWxsKSB7XG4gICAgICAgIHRoaXMuZmFpbHVyZS5lcnJvciA9IGZhaWx1cmVcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuZmFpbHVyZSA9IG5ldyBGYWlsKGZhaWx1cmUpXG4gICAgICB9XG5cbiAgICAgIHRoaXMucm9vdCA9IHRoaXMuZmFpbHVyZVxuICAgICAgdGhpcy5zY2hlZHVsZSgpXG4gICAgfVxuICB9XG4gIGtpbGwoZXhpdDogcmVhc29uKSB7XG4gICAgaWYgKHRoaXMuaXNBY3RpdmUpIHtcbiAgICAgIHRoaXMuaXNBY3RpdmUgPSBmYWxzZVxuICAgICAgaWYgKHRoaXMucm9vdC5hYm9ydCkge1xuICAgICAgICB0aGlzLnJvb3QuYWJvcnQodGhpcy5hYm9ydEhhbmRsZSlcbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgc2NoZWR1bGUoKSB7XG4gICAgaWYgKHRoaXMuaXNQYXVzZWQpIHtcbiAgICAgIHRoaXMuaXNQYXVzZWQgPSBmYWxzZVxuICAgICAgdGhpcy5zdGVwKClcbiAgICB9XG4gIH1cbiAgc3RlcCgpIHtcbiAgICBjb25zdCBwcm9jZXNzID0gdGhpc1xuICAgIHdoaWxlIChwcm9jZXNzLmlzQWN0aXZlKSB7XG4gICAgICBjb25zdCByb290ID0gcHJvY2Vzcy5yb290XG4gICAgICBzd2l0Y2ggKHJvb3QudHlwZSkge1xuICAgICAgICBjYXNlIFwiU3VjY2VlZFwiOiB7XG4gICAgICAgICAgY29uc3QgdGFzazogU3VjY2VlZDwqLCAqPiA9IChyb290OiBhbnkpXG4gICAgICAgICAgLy8gSWYgdGFzayBzdWNjZWVkZWQgc2tpcCBhbGwgdGhlIGVycm9yIGhhbmRsaW5nLlxuICAgICAgICAgIHdoaWxlIChcbiAgICAgICAgICAgIHByb2Nlc3MucG9zaXRpb24gPCBwcm9jZXNzLnN0YWNrLmxlbmd0aCAmJlxuICAgICAgICAgICAgcHJvY2Vzcy5zdGFja1twcm9jZXNzLnBvc2l0aW9uXSBpbnN0YW5jZW9mIENhdGNoXG4gICAgICAgICAgKSB7XG4gICAgICAgICAgICBwcm9jZXNzLnBvc2l0aW9uKytcbiAgICAgICAgICB9XG5cbiAgICAgICAgICAvLyBJZiBlbmQgb2YgdGhlIHN0YWNrIGlzIHJlYWNoZWQgdGhlbiBicmVha1xuICAgICAgICAgIGlmIChwcm9jZXNzLnBvc2l0aW9uID49IHByb2Nlc3Muc3RhY2subGVuZ3RoKSB7XG4gICAgICAgICAgICBpZiAocHJvY2Vzcy5zdWNjZWVkICE9IG51bGwpIHtcbiAgICAgICAgICAgICAgcHJvY2Vzcy5zdWNjZWVkKHRhc2sudmFsdWUpXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm5cbiAgICAgICAgICB9XG5cbiAgICAgICAgICAvLyBPdGhlcndpc2Ugc3RlcCBpbnRvIG5leHQgdGFzay5cbiAgICAgICAgICBjb25zdCB0aGVuID0gcHJvY2Vzcy5zdGFja1twcm9jZXNzLnBvc2l0aW9uKytdXG4gICAgICAgICAgaWYgKHRoZW4gaW5zdGFuY2VvZiBUaGVuKSB7XG4gICAgICAgICAgICBwcm9jZXNzLnJvb3QgPSB0aGVuLm5leHQodGFzay52YWx1ZSlcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBicmVha1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgXCJGYWlsXCI6IHtcbiAgICAgICAgICBjb25zdCB0YXNrOiBGYWlsPCosICo+ID0gKHJvb3Q6IGFueSlcbiAgICAgICAgICAvLyBJZiB0YXNrIGZhaWxzIHNraXAgYWxsIHRoZSBjaGFpbmluZy5cbiAgICAgICAgICB3aGlsZSAoXG4gICAgICAgICAgICBwcm9jZXNzLnBvc2l0aW9uIDwgcHJvY2Vzcy5zdGFjay5sZW5ndGggJiZcbiAgICAgICAgICAgIHByb2Nlc3Muc3RhY2tbcHJvY2Vzcy5wb3NpdGlvbl0gaW5zdGFuY2VvZiBUaGVuXG4gICAgICAgICAgKSB7XG4gICAgICAgICAgICBwcm9jZXNzLnBvc2l0aW9uKytcbiAgICAgICAgICB9XG5cbiAgICAgICAgICAvLyBJZiBlbmQgb2YgdGhlIHN0YWNrIGlzIHJlYWNoZWQgdGhlbiBicmVhay5cbiAgICAgICAgICBpZiAodGhpcy5wb3NpdGlvbiA+PSBwcm9jZXNzLnN0YWNrLmxlbmd0aCkge1xuICAgICAgICAgICAgaWYgKHByb2Nlc3MuZmFpbCAhPSBudWxsKSB7XG4gICAgICAgICAgICAgIHByb2Nlc3MuZmFpbCh0YXNrLmVycm9yKVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm5cbiAgICAgICAgICB9XG5cbiAgICAgICAgICAvLyBPdGhlcndpc2Ugc3RlcCBpbnRvIG5leHQgdGFzay5cbiAgICAgICAgICBjb25zdCBfY2F0Y2ggPSBwcm9jZXNzLnN0YWNrW3Byb2Nlc3MucG9zaXRpb24rK11cbiAgICAgICAgICBpZiAoX2NhdGNoIGluc3RhbmNlb2YgQ2F0Y2gpIHtcbiAgICAgICAgICAgIHByb2Nlc3Mucm9vdCA9IF9jYXRjaC5oYW5kbGUodGFzay5lcnJvcilcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBicmVha1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgXCJUaGVuXCI6IHtcbiAgICAgICAgICBjb25zdCB0YXNrOiBUaGVuPCosICosICo+ID0gKHJvb3Q6IGFueSlcbiAgICAgICAgICBpZiAocHJvY2Vzcy5wb3NpdGlvbiA9PT0gMCkge1xuICAgICAgICAgICAgcHJvY2Vzcy5zdGFjay51bnNoaWZ0KHRhc2spXG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHByb2Nlc3Muc3RhY2tbLS1wcm9jZXNzLnBvc2l0aW9uXSA9IHRhc2tcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBwcm9jZXNzLnJvb3QgPSB0YXNrLnRhc2tcblxuICAgICAgICAgIGJyZWFrXG4gICAgICAgIH1cbiAgICAgICAgY2FzZSBcIkNhdGNoXCI6IHtcbiAgICAgICAgICBjb25zdCB0YXNrOiBDYXRjaDwqLCAqLCAqPiA9IChyb290OiBhbnkpXG4gICAgICAgICAgaWYgKHByb2Nlc3MucG9zaXRpb24gPT09IDApIHtcbiAgICAgICAgICAgIHByb2Nlc3Muc3RhY2sudW5zaGlmdCh0YXNrKVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBwcm9jZXNzLnN0YWNrWy0tcHJvY2Vzcy5wb3NpdGlvbl0gPSB0YXNrXG4gICAgICAgICAgfVxuXG4gICAgICAgICAgcHJvY2Vzcy5yb290ID0gdGFzay50YXNrXG5cbiAgICAgICAgICBicmVha1xuICAgICAgICB9XG4gICAgICAgIGRlZmF1bHQ6IHtcbiAgICAgICAgICBjb25zdCB0YXNrID0gcm9vdFxuICAgICAgICAgIHByb2Nlc3MuaXNQZW5kaW5nID0gdHJ1ZVxuICAgICAgICAgIHByb2Nlc3MuYWJvcnRIYW5kbGUgPSB0YXNrLmZvcmsocHJvY2Vzcy5vblN1Y2NlZWQsIHByb2Nlc3Mub25GYWlsKVxuICAgICAgICAgIHByb2Nlc3MuaXNQYXVzZWQgPSBwcm9jZXNzLmlzUGVuZGluZ1xuICAgICAgICAgIGlmICh0aGlzLmlzUGVuZGluZykge1xuICAgICAgICAgICAgcmV0dXJuXG4gICAgICAgICAgfVxuXG4gICAgICAgICAgYnJlYWtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxufVxuIl19
(function (global, factory) {
  if (typeof define === "function" && define.amd) {
    define(["./test", "../"], factory);
  } else if (typeof exports !== "undefined") {
    factory(require("./test"), require("../"));
  } else {
    var mod = {
      exports: {}
    };
    factory(global.test, global._);
    global.testApi = mod.exports;
  }
})(this, function (_test, _) {
  "use strict";

  var _test2 = _interopRequireDefault(_test);

  var Reflex = _interopRequireWildcard(_);

  function _interopRequireWildcard(obj) {
    if (obj && obj.__esModule) {
      return obj;
    } else {
      var newObj = {};

      if (obj != null) {
        for (var key in obj) {
          if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key];
        }
      }

      newObj.default = obj;
      return newObj;
    }
  }

  function _interopRequireDefault(obj) {
    return obj && obj.__esModule ? obj : {
      default: obj
    };
  }

  (0, _test2.default)("test exported api", assert => {
    assert.ok(typeof Reflex.node, "function");

    assert.ok(typeof Reflex.html, "object");
    assert.ok(typeof Reflex.html.div, "function");

    assert.ok(typeof Reflex.thunk, "function");
    assert.ok(typeof Reflex.send, "function");
    assert.ok(typeof Reflex.forward, "function");

    assert.ok(typeof Reflex.Application, "function");

    assert.ok(typeof Reflex.Task.succeed, "function");
    assert.ok(typeof Reflex.Task.fail, "function");
    assert.ok(typeof Reflex.Task.io, "function");
    assert.ok(typeof Reflex.Task.onSuccess, "function");
    assert.ok(typeof Reflex.Task.onFailure, "function");
    assert.ok(typeof Reflex.Task.perform, "function");
    assert.ok(typeof Reflex.Task.run, "function");
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy90ZXN0L3Rlc3QtYXBpLmpzIl0sIm5hbWVzIjpbIlJlZmxleCIsImFzc2VydCIsIm9rIiwibm9kZSIsImh0bWwiLCJkaXYiLCJ0aHVuayIsInNlbmQiLCJmb3J3YXJkIiwiQXBwbGljYXRpb24iLCJUYXNrIiwic3VjY2VlZCIsImZhaWwiLCJpbyIsIm9uU3VjY2VzcyIsIm9uRmFpbHVyZSIsInBlcmZvcm0iLCJydW4iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7O01BQ1lBLE07Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFFWixzQkFBSyxtQkFBTCxFQUEwQkMsVUFBVTtBQUNsQ0EsV0FBT0MsRUFBUCxDQUFVLE9BQU9GLE9BQU9HLElBQXhCLEVBQStCLFVBQS9COztBQUVBRixXQUFPQyxFQUFQLENBQVUsT0FBT0YsT0FBT0ksSUFBeEIsRUFBK0IsUUFBL0I7QUFDQUgsV0FBT0MsRUFBUCxDQUFVLE9BQU9GLE9BQU9JLElBQVAsQ0FBWUMsR0FBN0IsRUFBbUMsVUFBbkM7O0FBRUFKLFdBQU9DLEVBQVAsQ0FBVSxPQUFPRixPQUFPTSxLQUF4QixFQUFnQyxVQUFoQztBQUNBTCxXQUFPQyxFQUFQLENBQVUsT0FBT0YsT0FBT08sSUFBeEIsRUFBK0IsVUFBL0I7QUFDQU4sV0FBT0MsRUFBUCxDQUFVLE9BQU9GLE9BQU9RLE9BQXhCLEVBQWtDLFVBQWxDOztBQUVBUCxXQUFPQyxFQUFQLENBQVUsT0FBT0YsT0FBT1MsV0FBeEIsRUFBc0MsVUFBdEM7O0FBR0FSLFdBQU9DLEVBQVAsQ0FBVSxPQUFPRixPQUFPVSxJQUFQLENBQVlDLE9BQTdCLEVBQXVDLFVBQXZDO0FBQ0FWLFdBQU9DLEVBQVAsQ0FBVSxPQUFPRixPQUFPVSxJQUFQLENBQVlFLElBQTdCLEVBQW9DLFVBQXBDO0FBQ0FYLFdBQU9DLEVBQVAsQ0FBVSxPQUFPRixPQUFPVSxJQUFQLENBQVlHLEVBQTdCLEVBQWtDLFVBQWxDO0FBQ0FaLFdBQU9DLEVBQVAsQ0FBVSxPQUFPRixPQUFPVSxJQUFQLENBQVlJLFNBQTdCLEVBQXlDLFVBQXpDO0FBQ0FiLFdBQU9DLEVBQVAsQ0FBVSxPQUFPRixPQUFPVSxJQUFQLENBQVlLLFNBQTdCLEVBQXlDLFVBQXpDO0FBQ0FkLFdBQU9DLEVBQVAsQ0FBVSxPQUFPRixPQUFPVSxJQUFQLENBQVlNLE9BQTdCLEVBQXVDLFVBQXZDO0FBQ0FmLFdBQU9DLEVBQVAsQ0FBVSxPQUFPRixPQUFPVSxJQUFQLENBQVlPLEdBQTdCLEVBQW1DLFVBQW5DO0FBQ0QsR0FwQkQiLCJmaWxlIjoidGVzdC1hcGkuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgdGVzdCBmcm9tIFwiLi90ZXN0XCJcbmltcG9ydCAqIGFzIFJlZmxleCBmcm9tIFwiLi4vXCJcblxudGVzdChcInRlc3QgZXhwb3J0ZWQgYXBpXCIsIGFzc2VydCA9PiB7XG4gIGFzc2VydC5vayh0eXBlb2YoUmVmbGV4Lm5vZGUpLCBcImZ1bmN0aW9uXCIpXG5cbiAgYXNzZXJ0Lm9rKHR5cGVvZihSZWZsZXguaHRtbCksIFwib2JqZWN0XCIpXG4gIGFzc2VydC5vayh0eXBlb2YoUmVmbGV4Lmh0bWwuZGl2KSwgXCJmdW5jdGlvblwiKVxuXG4gIGFzc2VydC5vayh0eXBlb2YoUmVmbGV4LnRodW5rKSwgXCJmdW5jdGlvblwiKVxuICBhc3NlcnQub2sodHlwZW9mKFJlZmxleC5zZW5kKSwgXCJmdW5jdGlvblwiKVxuICBhc3NlcnQub2sodHlwZW9mKFJlZmxleC5mb3J3YXJkKSwgXCJmdW5jdGlvblwiKVxuXG4gIGFzc2VydC5vayh0eXBlb2YoUmVmbGV4LkFwcGxpY2F0aW9uKSwgXCJmdW5jdGlvblwiKVxuXG5cbiAgYXNzZXJ0Lm9rKHR5cGVvZihSZWZsZXguVGFzay5zdWNjZWVkKSwgXCJmdW5jdGlvblwiKVxuICBhc3NlcnQub2sodHlwZW9mKFJlZmxleC5UYXNrLmZhaWwpLCBcImZ1bmN0aW9uXCIpXG4gIGFzc2VydC5vayh0eXBlb2YoUmVmbGV4LlRhc2suaW8pLCBcImZ1bmN0aW9uXCIpXG4gIGFzc2VydC5vayh0eXBlb2YoUmVmbGV4LlRhc2sub25TdWNjZXNzKSwgXCJmdW5jdGlvblwiKVxuICBhc3NlcnQub2sodHlwZW9mKFJlZmxleC5UYXNrLm9uRmFpbHVyZSksIFwiZnVuY3Rpb25cIilcbiAgYXNzZXJ0Lm9rKHR5cGVvZihSZWZsZXguVGFzay5wZXJmb3JtKSwgXCJmdW5jdGlvblwiKVxuICBhc3NlcnQub2sodHlwZW9mKFJlZmxleC5UYXNrLnJ1biksIFwiZnVuY3Rpb25cIilcbn0pXG4iXX0=
(function (global, factory) {
  if (typeof define === "function" && define.amd) {
    define(["exports", "tape"], factory);
  } else if (typeof exports !== "undefined") {
    factory(exports, require("tape"));
  } else {
    var mod = {
      exports: {}
    };
    factory(mod.exports, global.tape);
    global.test = mod.exports;
  }
})(this, function (exports, _tape) {
  "use strict";

  Object.defineProperty(exports, "__esModule", {
    value: true
  });

  var tape = _interopRequireWildcard(_tape);

  function _interopRequireWildcard(obj) {
    if (obj && obj.__esModule) {
      return obj;
    } else {
      var newObj = {};

      if (obj != null) {
        for (var key in obj) {
          if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key];
        }
      }

      newObj.default = obj;
      return newObj;
    }
  }

  exports.default = (description, unit) => tape.test(description, test => {
    var result = unit(test);
    if (result && result.then) {
      result.then(_ => test.end(), error => test.end(error || true));
    } else {
      test.end();
    }
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy90ZXN0L3Rlc3QuanMiXSwibmFtZXMiOlsidGFwZSIsImRlc2NyaXB0aW9uIiwidW5pdCIsInRlc3QiLCJyZXN1bHQiLCJ0aGVuIiwiXyIsImVuZCIsImVycm9yIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7O01BQVlBLEk7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7b0JBRUcsQ0FBQ0MsV0FBRCxFQUFjQyxJQUFkLEtBQXVCRixLQUFLRyxJQUFMLENBQVVGLFdBQVYsRUFBdUJFLFFBQVE7QUFDbkUsUUFBSUMsU0FBU0YsS0FBS0MsSUFBTCxDQUFiO0FBQ0EsUUFBSUMsVUFBVUEsT0FBT0MsSUFBckIsRUFBMkI7QUFDekJELGFBQU9DLElBQVAsQ0FBWUMsS0FBS0gsS0FBS0ksR0FBTCxFQUFqQixFQUE2QkMsU0FBU0wsS0FBS0ksR0FBTCxDQUFTQyxTQUFTLElBQWxCLENBQXRDO0FBQ0QsS0FGRCxNQUVPO0FBQ0xMLFdBQUtJLEdBQUw7QUFDRDtBQUNGLEdBUHFDLEMiLCJmaWxlIjoidGVzdC5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIHRhcGUgZnJvbSBcInRhcGVcIlxuXG5leHBvcnQgZGVmYXVsdCAoZGVzY3JpcHRpb24sIHVuaXQpID0+IHRhcGUudGVzdChkZXNjcmlwdGlvbiwgdGVzdCA9PiB7XG4gIHZhciByZXN1bHQgPSB1bml0KHRlc3QpXG4gIGlmIChyZXN1bHQgJiYgcmVzdWx0LnRoZW4pIHtcbiAgICByZXN1bHQudGhlbihfID0+IHRlc3QuZW5kKCksIGVycm9yID0+IHRlc3QuZW5kKGVycm9yIHx8IHRydWUpKVxuICB9IGVsc2Uge1xuICAgIHRlc3QuZW5kKClcbiAgfVxufSlcbiJdfQ==
